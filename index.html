<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>FAMILIADA - TV</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #000033; color: #f1c40f; font-family: 'VT323', monospace; text-align: center; margin: 0; overflow: hidden; }
        #setup-screen { position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #000033; z-index: 100; }
        #id-box { font-size: 100px; background: white; color: black; padding: 10px 40px; margin: 20px; border-radius: 10px; }
        #game-screen { display: none; height: 100vh; flex-direction: column; }
        .header { display: flex; justify-content: space-between; padding: 20px 50px; background: rgba(0,0,0,0.5); border-bottom: 4px solid #444; }
        .score { font-size: 80px; border: 4px solid white; padding: 10px 30px; min-width: 100px; background: black; }
        #board { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .row { width: 80%; background: linear-gradient(to bottom, #0000aa, #000066); border: 2px solid #888; margin: 8px; padding: 15px 30px; font-size: 45px; display: flex; justify-content: space-between; color: white; }
        #strike-box { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.4); font-size: 500px; color: red; z-index: 1000; text-shadow: 15px 15px 0 black; }
        #timer { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 300px; color: red; display: none; z-index: 1100; }
    </style>
</head>
<body>
    <div id="setup-screen">
        <h1>TWOJE ID TELEWIZORA:</h1>
        <div id="id-box">CZEKAJ...</div>
        <p>Wpisz ten kod w panelu i grzybkach</p>
    </div>

    <div id="game-screen">
        <div class="header">
            <div id="sA" class="score" style="color:#ff4757">0</div>
            <div style="font-size: 40px;">FAMILIADA<br><span id="round-name">RUNDA 1</span></div>
            <div id="sB" class="score" style="color:#2e86de">0</div>
        </div>
        <div id="question" style="font-size: 50px; margin-top: 20px;">OCZEKIWANIE NA PYTANIE...</div>
        <div id="board"></div>
    </div>

    <div id="strike-box">X</div>
    <div id="timer">00</div>

    <script>
        const peer = new Peer();
        peer.on('open', id => document.getElementById('id-box').innerText = id);
        peer.on('connection', conn => {
            conn.on('data', m => {
                document.getElementById('setup-screen').style.display = 'none';
                document.getElementById('game-screen').style.display = 'flex';
                
                if(m.type === 'SETUP') {
                    document.getElementById('question').innerText = m.q;
                    const b = document.getElementById('board'); b.innerHTML = '';
                    m.a.forEach((ans, i) => b.innerHTML += `<div class="row" id="r-${i}"><span>${i+1}. ...................</span><span>--</span></div>`);
                }
                if(m.type === 'REVEAL') {
                    const r = document.getElementById(`r-${m.index}`);
                    r.innerHTML = `<span>${m.index+1}. ${m.text}</span><span>${m.pts}</span>`;
                    new Audio('https://www.myinstants.com/media/sounds/ding-sound-effect_2.mp3').play();
                }
                if(m.type === 'STRIKE') {
                    const s = document.getElementById('strike-box'); s.style.display = 'flex';
                    new Audio('https://www.myinstants.com/media/sounds/incorrect_6.mp3').play();
                    setTimeout(() => s.style.display = 'none', 1200);
                }
                if(m.type === 'UPDATE') {
                    document.getElementById('sA').innerText = m.scA;
                    document.getElementById('sB').innerText = m.scB;
                }
                if(m.type === 'TIMER') {
                    const t = document.getElementById('timer'); t.innerText = m.val;
                    t.style.display = m.visible ? 'block' : 'none';
                }
            });
        });
    </script>
</body>
</html>
