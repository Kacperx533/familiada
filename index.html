<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>FAMILIADA TV - FINAL</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #000; color: #f5b041; font-family: 'VT323', monospace; margin: 0; overflow: hidden; }
        
        /* TÅ‚o tablicy z kropkami */
        .board-container {
            width: 100vw; height: 100vh;
            background: radial-gradient(circle, #1a1a1a 1px, transparent 1px);
            background-size: 4px 4px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .board-frame {
            border: 8px solid #333; border-radius: 20px;
            padding: 40px; background: #050505; width: 80%;
            box-shadow: inset 0 0 50px #000; position: relative;
        }

        .row { display: flex; font-size: 70px; height: 80px; align-items: center; margin-bottom: 5px; }
        .row-num { width: 60px; color: #f5b041; text-align: left; }
        .row-text { flex-grow: 1; color: #f5b041; }
        .row-pts { width: 100px; text-align: right; }
        .dots { color: #222; letter-spacing: 5px; }

        .suma-row { 
            display: flex; justify-content: flex-end; 
            font-size: 80px; margin-top: 30px; border-top: 2px solid #222; padding-top: 10px;
        }

        /* Multimedia - Video */
        #video-player {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 2000; display: none;
        }

        /* Wielki X */
        #strike-overlay {
            display: none; position: fixed; inset: 0; z-index: 1500;
            background: rgba(0,0,0,0.8); justify-content: center; align-items: center;
        }
    </style>
</head>
<body>

    <video id="video-player"></video>

    <div id="strike-overlay">
        <img src="https://i.imgur.com/8W77G3R.png" width="500"> </div>

    <div class="board-container">
        <div class="board-frame">
            <div id="board-ui"></div>
            <div class="suma-row">
                <span style="margin-right: 50px;">SUMA</span>
                <span id="total-val">0</span>
            </div>
        </div>
    </div>

    <script>
        const peer = new Peer();
        const vPlayer = document.getElementById('video-player');

        peer.on('open', id => console.log('ID:', id));

        peer.on('connection', conn => {
            conn.on('data', m => {
                if(m.type === 'SETUP') {
                    const b = document.getElementById('board-ui');
                    b.innerHTML = "";
                    m.a.forEach((ans, i) => {
                        b.innerHTML += `
                            <div class="row" id="row-${i}">
                                <span class="row-num">${i+1}</span>
                                <span class="row-text"><span class="dots">............................</span></span>
                                <span class="row-pts"></span>
                            </div>`;
                    });
                }
                
                if(m.type === 'REVEAL') {
                    const r = document.getElementById(`row-${m.index}`);
                    r.querySelector('.row-text').innerText = m.text.toUpperCase();
                    r.querySelector('.row-pts').innerText = m.pts;
                    updateTotal(m.total);
                }

                if(m.type === 'STRIKE') {
                    const ov = document.getElementById('strike-overlay');
                    ov.style.display = 'flex';
                    setTimeout(() => ov.style.display = 'none', 1500);
                }

                if(m.type === 'START_INTRO') playMedia('intro.mp4');
                if(m.type === 'START_OUTRO') playMedia('outro.mp4');
            });
        });

        function playMedia(file) {
            vPlayer.src = file;
            vPlayer.style.display = 'block';
            vPlayer.play();
            vPlayer.onended = () => vPlayer.style.display = 'none';
        }

        function updateTotal(val) {
            document.getElementById('total-val').innerText = val;
        }
    </script>
</body>
</html>
