<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL FINA≈ÅOWY - FAMILIADA</title>
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; padding: 15px; margin: 0; }
        .main-wrapper { max-width: 1100px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px; }
        
        /* Styl kart jak w panelu sterowania */
        .card { background: #1e293b; padding: 15px; border-radius: 10px; border: 1px solid #334155; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        h2 { color: #facc15; font-size: 14px; margin: 0 0 12px 0; border-bottom: 1px solid #334155; padding-bottom: 5px; text-transform: uppercase; }
        
        .grid-players { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .row-final { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; background: #0f172a; padding: 5px; border-radius: 6px; }

        /* LED jak w panelu sterowania */
        .led { width: 15px; height: 15px; border-radius: 50%; background: #334155; flex-shrink: 0; }
        .led-active { background: #22c55e; box-shadow: 0 0 10px #22c55e; }

        input { flex: 1; padding: 8px; background: #1e293b; border: 1px solid #3b82f6; color: #fff; border-radius: 4px; font-size: 13px; }
        .input-pts { width: 45px; flex: none; text-align: center; color: #facc15; font-weight: bold; }

        button { padding: 8px 10px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 10px; transition: 0.2s; }
        .btn-blue { background: #3b82f6; color: white; }
        .btn-green { background: #22c55e; color: white; }
        .btn-gold { background: #eab308; color: black; }
        .btn-red { background: #ef4444; color: white; }

        /* Tabela pyta≈Ñ */
        .cheat-table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
        .cheat-table th, .cheat-table td { border: 1px solid #334155; padding: 6px; text-align: left; }
        .cheat-table th { background: #0f172a; color: #facc15; }
        .cheat-table tr:hover { background: #2d3748; }

        .total-display { font-size: 40px; text-align: center; color: #facc15; font-weight: bold; margin: 10px 0; border: 2px dashed #3b82f6; border-radius: 10px; padding: 10px; }
    </style>
</head>
<body>

<div class="main-wrapper">
    <div class="card">
        <div style="display: flex; gap: 10px;">
            <input type="text" id="code" placeholder="KOD Z TABLICY">
            <button onclick="connect()" class="btn-green" style="width: 150px;">PO≈ÅƒÑCZ</button>
        </div>
    </div>

    <div class="card">
        <h2>STEROWANIE FINA≈ÅEM</h2>
        <button onclick="send('SND',{f:'final'})" class="btn-gold" style="width:100%; height: 45px; font-size: 14px; margin-bottom: 15px;">üéµ PRZERYWNIK / START FINA≈ÅU</button>
        
        <div class="grid-players">
            <div>
                <h2 style="text-align:center">GRACZ 1</h2>
                <div id="g1-rows"></div>
            </div>
            <div>
                <h2 style="text-align:center">GRACZ 2</h2>
                <div id="g2-rows"></div>
            </div>
        </div>

        <div class="total-display">SUMA: <span id="f-total">0</span></div>
        <button onclick="send('SND',{f:'powtorzenie'})" class="btn-red" style="width:100%; padding: 12px;">D≈πWIƒòK POWT√ìRZENIA (BRZDƒòK)</button>
    </div>

    <div class="card">
        <h2>üìã BAZA 10 FINA≈Å√ìW (≈öCIƒÑGA)</h2>
        <table class="cheat-table">
            <thead>
                <tr>
                    <th>Nr</th>
                    <th>Pytania i najwy≈ºej punktowane odpowiedzi (TOP 2)</th>
                </tr>
            </thead>
            <tbody id="cheat-body"></tbody>
        </table>
    </div>
</div>

<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
<script>
    let conn, peer = new Peer(), totalF = 0;

    const finals = [
        {id: 1, data: "1. Wiƒôcej ni≈º jedno: STADO(40) PARA(25) | 2. Owoc: JAB≈ÅKO(35) BANAN(20) | 3. Zimne: L√ìD(50) LODY(30) | 4. Ptak: WR√ìBEL(30) ORZE≈Å(20) | 5. Rzeka: WIS≈ÅA(60) ODRA(15)"},
        {id: 2, data: "1. W kuchni: N√ì≈ª(35) GARNEK(25) | 2. S≈Çodkie: CUKIER(40) MI√ìD(20) | 3. Pa≈Ñstwo: POLSKA(45) NIEMCY(15) | 4. Drzewo: DƒÑB(30) SOSNA(20) | 5. Kolor: NIEBIESKI(35) CZERWONY(25)"},
        {id: 3, data: "1. Na ≈õniadanie: JAJECZNICA(30) KANAPKA(25) | 2. Nap√≥j: WODA(40) KAWA(20) | 3. Kwiat: R√ì≈ªA(45) TULIPAN(20) | 4. Ryba: KARP(35) ≈öLED≈π(25) | 5. Metal: ≈ªELAZO(30) Z≈ÅOTO(20)"},
        {id: 4, data: "1. Sport: PI≈ÅKA NO≈ªNA(50) TENIS(15) | 2. Mebel: ST√ì≈Å(35) KRZES≈ÅO(25) | 3. Owad: MUCHA(30) PSZCZO≈ÅA(25) | 4. Miasto: WARSZAWA(40) KRAK√ìW(20) | 5. Instrument: GITARA(35) PIANINO(20)"},
        {id: 5, data: "1. Warzywo: MARCHEW(35) ZIEMNIAK(30) | 2. Planeta: ZIEMIA(40) MARS(20) | 3. ≈örodek lokomocji: AUTO(45) POCIƒÑG(20) | 4. Czƒô≈õƒá cia≈Ça: RƒòKA(30) G≈ÅOWA(25) | 5. Imiƒô mƒôskie: JAN(30) ADAM(20)"},
        {id: 6, data: "1. Narzƒôdzie: M≈ÅOTEK(40) PI≈ÅA(20) | 2. Zwierzƒô domowe: PIES(50) KOT(35) | 3. Co≈õ co ≈õwieci: S≈ÅO≈ÉCE(45) ≈ªAR√ìWKA(25) | 4. Szko≈Ça: TABLICA(30) ZESZYT(20) | 5. Ubranie: SPODNIE(30) KOSZULA(25)"},
        {id: 7, data: "1. Marka auta: FIAT(25) TOYOTA(20) | 2. MiesiƒÖc: MAJ(30) GRUDZIE≈É(25) | 3. Pora roku: LATO(60) WIOSNA(20) | 4. Budynek: DOM(45) BLOK(25) | 5. Jƒôzyk: POLSKI(40) ANGIELSKI(35)"},
        {id: 8, data: "1. Gra: SZACHY(30) KARTY(25) | 2. Las: DRZEWA(50) GRZYBY(20) | 3. Co≈õ okrƒÖg≈Çego: KO≈ÅO(40) PI≈ÅKA(30) | 4. Przyprawa: S√ìL(45) PIEPRZ(35) | 5. ≈ªywio≈Ç: OGIE≈É(35) WODA(30)"},
        {id: 9, data: "1. Stolica: PARY≈ª(30) LONDYN(25) | 2. Bajka: MYSZKA MIKI(35) SMURF(20) | 3. Praca: BIURO(30) BUDOWA(20) | 4. Pogoda: DESZCZ(35) S≈ÅO≈ÉCE(35) | 5. Waluta: Z≈ÅOTY(50) EURO(30)"},
        {id: 10, data: "1. G√≥ry: TATRY(65) ALPY(15) | 2. Morze: BA≈ÅTYK(70) CZERWONE(10) | 3. Nap√≥j gazowany: COLA(45) ORAN≈ªADA(15) | 4. Kosmos: GWIAZDY(40) KSIƒò≈ªYC(30) | 5. P≈Çyn: WODA(55) MLEKO(20)"}
    ];

    function connect() {
        const code = document.getElementById('code').value.toUpperCase();
        conn = peer.connect(code);
        conn.on('open', () => { alert("PO≈ÅƒÑCZONO!"); send('FIN'); });
    }

    function send(type, data={}) { if(conn) conn.send({type, ...data}); }

    function render() {
        // Generowanie p√≥l graczy
        [1, 2].forEach(p => {
            const container = document.getElementById(`g${p}-rows`);
            for(let i=0; i<5; i++) {
                container.innerHTML += `
                    <div class="row-final">
                        <div class="led" id="led-p${p}-r${i}"></div>
                        <input id="f${p}t${i}" placeholder="Odpowied≈∫">
                        <button onclick="revFA(${p},${i})" class="btn-blue">ODP</button>
                        <input id="f${p}p${i}" type="number" class="input-pts" placeholder="0">
                        <button onclick="revFP(${p},${i})" class="btn-green">ZATWIERD≈π</button>
                    </div>`;
            }
        });

        // Generowanie ≈õciƒÖgi
        const body = document.getElementById('cheat-body');
        finals.forEach(f => {
            body.innerHTML += `<tr><td>${f.id}</td><td>${f.data}</td></tr>`;
        });
    }

    function revFA(pl, i) { 
        send('SND', {f:'ok'}); 
        send('R_A', {pl, i, t: document.getElementById(`f${pl}t${i}`).value}); 
    }

    function revFP(pl, i) { 
        const pVal = parseInt(document.getElementById(`f${pl}p${i}`).value) || 0; 
        totalF += pVal; 
        document.getElementById('f-total').innerText = totalF;
        send('SND', {f:'final'}); 
        send('R_P', {pl, i, p: pVal, s: totalF}); 
        
        // Zapalenie diody w panelu fina≈Çowym
        document.getElementById(`led-p${pl}-r${i}`).classList.add('led-active');
        // Synchronizacja z panelem g≈Ç√≥wnym
        send('LED_SYNC', {player: pl, row: i});
    }

    render();
</script>
</body>
</html>
