<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>FAMILIADA - PANEL</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #2d2d2d; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        button { padding: 12px; margin: 4px 0; width: 100%; cursor: pointer; font-weight: bold; border-radius: 4px; border: none; }
        .gold { background: #ffcc00; } .blue { background: #0055ff; color: white; } .red { background: #ff0044; color: white; }
        .active { outline: 4px solid white; }
        input, select { width: 100%; padding: 10px; margin: 5px 0; box-sizing: border-box; }
    </style>
</head>
<body>

    <div class="left">
        <div class="card">
            <h3>1. PO≈ÅƒÑCZENIE</h3>
            <input type="text" id="tv-id" placeholder="Wklej ID z TV">
            <button class="gold" onclick="connect()">PO≈ÅƒÑCZ Z EKRANEM</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button onclick="send({type:'VIDEO', file:'czolowka.mp4'})">üé¨ CZO≈Å√ìWKA (.mp4)</button>
            <button onclick="send({type:'VIDEO', file:'napisy.mp4'})">üìù NAPISY KO≈ÉCOWE (.mp4)</button>
            <button style="background: orange;" onclick="send({type:'REPEAT'})">üîî POWT√ìRZENIE (.mp3)</button>
            <button class="red" onclick="send({type:'STRIKE'})">‚ùå B≈ÅƒÑD (X)</button>
        </div>

        <div class="card">
            <h3>3. WYNIKI</h3>
            <div style="display:flex; gap:10px;">
                <button id="btn-a" class="blue" onclick="selTeam('A')">DRU≈ªYNA A: <span id="s-a">0</span></button>
                <button id="btn-b" class="red" onclick="selTeam('B')">DRU≈ªYNA B: <span id="s-b">0</span></button>
            </div>
            <div style="text-align:center; font-size:20px; margin:10px;">RUNDA: <span id="s-r">0</span></div>
            <button class="gold" onclick="addPts()">PRZYPISZ PUNKTY DO AKTYWNEJ</button>
        </div>
    </div>

    <div class="right">
        <div class="card">
            <h3>4. PYTANIA NORMALNE</h3>
            <select id="q-sel" onchange="preview()"></select>
            <button class="gold" onclick="sendSetup()">WY≈öLIJ NA TABLICƒò</button>
            <div id="ans-list"></div>
        </div>

        <div class="card">
            <h3>5. FINA≈Å</h3>
            <select id="f-sel">
                <option value="0">Fina≈Ç 1: Kuchnia / Sport</option>
                <option value="1">Fina≈Ç 2: Zwierzƒôta / Miasta</option>
                <option value="2">Fina≈Ç 3: Szko≈Ça / Dom</option>
            </select>
            <button onclick="send({type:'SETUP_FINAL'})">W≈ÅƒÑCZ TABLICƒò FINA≈ÅOWƒÑ</button>
            <div id="final-inputs">
                <h4>GRACZ 1 / GRACZ 2</h4>
                <div id="f-rows-inputs"></div>
            </div>
        </div>
    </div>

    <script>
        const db = [
            {q:"Wiƒôcej ni≈º jedno zwierzƒô?", a:[["OWCE",41],["LAMA",28],["STADO",16],["WATAHA",5],["PARA",3]]},
            {q:"Przedmiot szkolny?", a:[["MATEMATYKA",45],["POLSKI",25],["WF",15],["HISTORIA",10],["GEOGRAFIA",5]]},
            {q:"Co robimy w lesie?", a:[["SPACERUJEMY",42],["GRZYBY",30],["BIEGAMY",12],["ODPOCZYNEK",8]]},
            {q:"Zwierzƒô na K?", a:[["KOT",40],["KO≈É",25],["KROWA",15],["KANGUR",10],["KROKODYL",5]]},
            {q:"Co≈õ co ma klucze?", a:[["WO≈πNY",35],["FORTEPIAN",24],["BRAMA",18],["SAMOCH√ìD",12],["MAPA",6]]},
            {q:"Co k≈Çadziemy na kanapkƒô?", a:[["SER",35],["SZYNKA",30],["POMIDOR",15],["MAS≈ÅO",12],["SA≈ÅATA",8]]},
            {q:"Pojazd bez silnika?", a:[["ROWER",55],["HULAJNOGA",20],["W√ìZEK",12],["SANKI",8]]},
            {q:"Co≈õ gorƒÖcego?", a:[["HERBATA",40],["S≈ÅO≈ÉCE",30],["PIEKARNIK",15],["OGIE≈É",10]]}
        ];

        const finals = [
            ["Zwierzƒô na P", "Rzecz w kuchni", "Dyscyplina sportu", "Kolor kwiat√≥w", "Marka auta"],
            ["Pa≈Ñstwo w Europie", "Instrument muzyczny", "Ptak domowy", "Imiƒô na A", "Czƒô≈õƒá garderoby"],
            ["Rodzaj drzewa", "S≈Çodki owoc", "Wyposa≈ºenie salonu", "Ryba s≈Çodkowodna", "Stolica pa≈Ñstwa"]
        ];

        let peer = new Peer(), conn, scoreA=0, scoreB=0, scoreR=0, team='A';

        window.onload = () => {
            const sel = document.getElementById('q-sel');
            db.forEach((it, i) => sel.innerHTML += `<option value="${i}">${it.q}</option>`);
            
            const finDiv = document.getElementById('f-rows-inputs');
            for(let i=0; i<5; i++) {
                finDiv.innerHTML += `
                    <div style="display:flex; gap:5px; margin-bottom:5px;">
                        <input id="f-a-${i}" placeholder="Odp">
                        <input id="f-p-${i}" type="number" placeholder="Pts" style="width:60px">
                        <button onclick="revealFinal(1,${i})" style="width:40px">P1</button>
                        <button onclick="revealFinal(2,${i})" style="width:40px">P2</button>
                    </div>`;
            }
            preview(); selTeam('A');
        };

        function connect() { conn = peer.connect(document.getElementById('tv-id').value); alert("≈ÅƒÖczenie..."); }
        function send(d) { if(conn) conn.send(d); }

        function preview() {
            const data = db[document.getElementById('q-sel').value];
            const div = document.getElementById('ans-list'); div.innerHTML = "";
            data.a.forEach((ans, i) => {
                div.innerHTML += `<button onclick="reveal(${i}, ${ans[1]})">${ans[0]} (${ans[1]})</button>`;
            });
        }

        function sendSetup() {
            scoreR = 0; updateUI();
            const data = db[document.getElementById('q-sel').value];
            send({type:'SETUP_ROUND', answers: data.a.map(x=>({text:x[0], points:x[1]}))});
        }

        function reveal(idx, pts) { scoreR += pts; updateUI(); send({type:'REVEAL', idx:idx}); sync(); }
        function selTeam(t) { team = t; document.getElementById('btn-a').classList.toggle('active', t==='A'); document.getElementById('btn-b').classList.toggle('active', t==='B'); }
        function addPts() { if(team==='A') scoreA += scoreR; else scoreB += scoreR; scoreR = 0; updateUI(); sync(); }
        function updateUI() { document.getElementById('s-a').innerText = scoreA; document.getElementById('s-b').innerText = scoreB; document.getElementById('s-r').innerText = scoreR; }
        function sync() { send({type:'SCORE', r:scoreR, t:scoreA+scoreB}); }
        function revealFinal(p, i) {
            const ans = document.getElementById(`f-a-${i}`).value.toUpperCase();
            const pts = document.getElementById(`f-p-${i}`).value || 0;
            send({type:'FINAL_REVEAL', p:p, i:i, ans:ans, pts:pts});
        }
    </script>
</body>
</html>
