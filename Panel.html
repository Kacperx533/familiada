<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #fff; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #222; padding: 15px; border-radius: 10px; border-top: 4px solid gold; }
        button { padding: 10px; margin: 4px 0; width: 100%; cursor: pointer; font-weight: bold; border-radius: 5px; border: none; }
        .gold { background: gold; } .blue { background: #0055ff; color: #fff; } .red { background: #ff0044; color: #fff; }
        input, select { width: 100%; padding: 10px; margin: 5px 0; background: #000; color: #fff; border: 1px solid #444; }
    </style>
</head>
<body>
    <div>
        <div class="card">
            <input type="text" id="tv-id" placeholder="ID z TV">
            <button class="gold" onclick="conn = peer.connect(document.getElementById('tv-id').value)">PO≈ÅƒÑCZ</button>
        </div>
        <div class="card">
            <h3>AUDIO / VIDEO</h3>
            <button onclick="send({type:'INTRO'})">üé¨ CZO≈Å√ìWKA (VIDEO)</button>
            <button class="gold" onclick="send({type:'BG_MUSIC', play:true})">üéµ MUZYKA T≈ÅA (START)</button>
            <button onclick="send({type:'BG_MUSIC', play:false})">üîá MUZYKA T≈ÅA (STOP)</button>
            <button style="background:orange" onclick="send({type:'REPEAT'})">üîî POWT√ìRZENIE</button>
            <button class="red" onclick="send({type:'GO_FINAL'})">üèÅ FINA≈Å (D≈πWIƒòK)</button>
        </div>
        <div class="card">
            <h3>PUNKTY</h3>
            <div style="display:flex; gap:5px;"><button class="blue" onclick="team='A'">LEWA</button><button class="red" onclick="team='B'">PRAWA</button></div>
            <button class="red" style="margin-top:10px" onclick="send({type:'STRIKE', team:team})">‚ùå B≈ÅƒÑD (X)</button>
            <h2 id="scr">0</h2>
            <button class="gold" onclick="scr=0; send({type:'SCORE', r:0})">RESRT PUNKT√ìW RUNDY</button>
        </div>
    </div>
    <div>
        <div class="card">
            <h3>PYTANIA</h3>
            <select id="r-sel"><option value="1">R1 (x1)</option><option value="2">R2 (x1)</option><option value="3">R3 (x2)</option><option value="4">R4 (x3)</option></select>
            <select id="q-sel" onchange="preview()"></select>
            <button class="gold" onclick="sendSetup()">WY≈öLIJ NA TABLICƒò</button>
            <div id="ans"></div>
        </div>
    </div>

    <script>
        const db = [
            {q:"Przedmiot szkolny?", a:[["MATEMATYKA",45],["POLSKI",25],["WF",15],["HISTORIA",10]]},
            {q:"Co robimy na przerwie?", a:[["JEMY",40],["GADAMY",30],["BIEGAMY",20]]}
        ];
        let peer = new Peer(), conn, scr=0, team='A';
        window.onload = () => {
            const s = document.getElementById('q-sel');
            db.forEach((it, i) => s.innerHTML += `<option value="${i}">${it.q}</option>`);
            preview();
        };
        function send(d) { if(conn) conn.send(d); }
        function preview() {
            const d = db[document.getElementById('q-sel').value];
            const div = document.getElementById('ans'); div.innerHTML = "";
            d.a.forEach((ans, i) => { div.innerHTML += `<button onclick="reveal(${i}, ${ans[1]})">${ans[0]} (${ans[1]})</button>`; });
        }
        function sendSetup() {
            scr = 0; document.getElementById('scr').innerText = 0;
            const q = db[document.getElementById('q-sel').value];
            const r = document.getElementById('r-sel').value;
            const m = r == 3 ? 2 : (r == 4 ? 3 : 1);
            send({type:'SETUP_ROUND', rNum:r, mult:m, answers: q.a.map(x=>({text:x[0], points:x[1]}))});
        }
        function reveal(i, p) {
            const r = document.getElementById('r-sel').value;
            const m = r == 3 ? 2 : (r == 4 ? 3 : 1);
            scr += (p * m); document.getElementById('scr').innerText = scr;
            send({type:'REVEAL', idx:i}); send({type:'SCORE', r:scr});
        }
    </script>
</body>
</html>
