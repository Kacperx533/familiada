<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - FAMILIADA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; display: grid; grid-template-columns: 350px 1fr 350px; gap: 20px; padding: 20px; }
        .card { background: #1e1e1e; padding: 15px; border-radius: 10px; border-top: 4px solid #e2ff00; margin-bottom: 15px; }
        button { width: 100%; padding: 10px; margin: 4px 0; cursor: pointer; font-weight: bold; border-radius: 5px; border: none; background: #333; color: white; font-size: 13px; }
        .btn-gold { background: #e2ff00; color: black; }
        .btn-red { background: #ff3333; }
        .score-box { font-size: 30px; text-align: center; background: #000; color: #e2ff00; padding: 10px; margin: 10px 0; border: 1px solid #333; }
        input, select { width: 100%; padding: 10px; background: #000; color: white; border: 1px solid #444; margin-bottom: 10px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .ans-preview-btn { background: #222; text-align: left; padding-left: 10px; border-left: 3px solid #e2ff00; }
        h3 { color: #e2ff00; text-transform: uppercase; font-size: 14px; margin-top: 0; }
        .final-hints-box { font-size: 11px; color: #aaa; background: #000; padding: 8px; border-radius: 5px; line-height: 1.4; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div>
        <div class="card">
            <h3>SYSTEM</h3>
            <input id="tv-id" placeholder="Wpisz ID z ekranu TV">
            <button class="btn-gold" onclick="connect()">PO≈ÅƒÑCZ Z TV</button>
        </div>
        <div class="card">
            <h3>MULTIMEDIA</h3>
            <button class="btn-gold" onclick="send({type:'PLAY_MEDIA', video:'czolowka.mp4'})">üé¨ CZO≈Å√ìWKA (TYLKO WIDEO)</button>
            <button style="background: #444;" onclick="send({type:'PLAY_MEDIA', audio:'intro'})">üéµ SAMA MUZYKA INTRO</button>
            <button onclick="send({type:'PLAY_MEDIA', video:'runda.mp4', audio:'runda'})">RUNDA START</button>
            <button onclick="send({type:'PLAY_MEDIA', video:'final.mp4'})">üèÜ FINA≈Å WIDEO</button>
            <button onclick="send({type:'PLAY_MEDIA', video:'powtorka.mp4', audio:'powtorzenie'})">üîÑ POWT√ìRZENIE</button>
            <button class="btn-red" onclick="send({type:'STOP_VIDEO'})">STOP WIDEO</button>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>RUNDY (50 PYTA≈É)</h3>
            <select id="q-select" onchange="previewQ()"></select>
            <button class="btn-gold" onclick="sendQ()">WY≈öLIJ PYTANIE NA TV</button>
            <div id="ans-preview" style="height: 300px; overflow-y: auto; margin: 10px 0; padding-right: 5px;"></div>
            <div class="score-box">SUMA: <span id="current-sum">0</span></div>
            <div class="grid">
                <button class="btn-red" onclick="sendX(1)">X</button>
                <button class="btn-red" onclick="sendX(3)">XXX</button>
                <button onclick="send({type:'X', side:'L', n:0}); send({type:'X', side:'R', n:0});">CZY≈öƒÜ X</button>
                <button id="side-btn" onclick="toggleSide()">STRONA: LEWA</button>
            </div>
            <button onclick="sum=0; updateS(); send({type:'SCORE', val:0});" style="margin-top:10px">RESTART PUNKT√ìW</button>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>FINA≈Å (10 ZESTAW√ìW)</h3>
            <button class="btn-gold" onclick="send({type:'SETUP_FINAL'})">TABELA FINA≈ÅOWA</button>
            <div class="grid"><button onclick="runTimer(15)">15s</button><button onclick="runTimer(20)">20s</button></div>
            <select id="f-set-select" onchange="showFHints()" style="margin-top:10px"></select>
            <div id="f-hints" class="final-hints-box"></div>
            <div id="f-inputs" style="height: 300px; overflow-y: auto;"></div>
        </div>
    </div>

    <script>
        const DB = [
            {q:"Zwierzƒô na literƒô P", a:[["PIES",44],["PTAK",18],["PANDA",12],["PCH≈ÅA",6],["PAW",4]]},
            {q:"Wiƒôcej ni≈º jedno zwierzƒô", a:[["STADO",51],["KLUCZ",17],["WATAHA",11],["≈ÅAWICA",8],["SFORA",5]]},
            {q:"Co≈õ co parzy", a:[["POKRZYWA",38],["OGIE≈É",31],["WRZƒÑTEK",19],["S≈ÅO≈ÉCE",7],["MEDUZA",3]]},
            {q:"Przedmiot w kuchni na T", a:[["TALERZ",45],["TARKA",21],["TOSTER",11],["TEFLON",6]]},
            {q:"Co robimy rano?", a:[["MYJEMY SIƒò",35],["PIJEMY KAWƒò",24],["≈öNIADANIE",19],["UBIERANIE",12],["≈öCIELENIE",5]]},
            {q:"Czƒô≈õƒá garderoby na zimƒô", a:[["CZAPKA",40],["SZALIK",22],["RƒòKAWICZKI",17],["KURTKA",13],["KO≈ªUCH",4]]},
            {q:"Sk≈Çadnik pizzy", a:[["SER",55],["SZYNKA",15],["PIECZARKI",12],["SOS",9],["CEBULA",4]]},
            {q:"Dyscyplina lekkoatletyczna", a:[["BIEG",48],["SKOK W DAL",19],["RZUT OSZCZEPEM",11],["PCHNIƒòCIE KULƒÑ",7]]},
            {q:"Co mo≈ºna otworzyƒá?", a:[["OKNO",39],["DRZWI",29],["BUTELKƒò",14],["OCZY",10],["KONTO",4]]},
            {q:"Zwierzƒô wiejskie", a:[["KURA",43],["KROWA",21],["≈öWINIA",16],["KACZKA",9],["KO≈É",6]]},
            {q:"Co kojarzy siƒô z PolskƒÖ?", a:[["PIEROGI",35],["BOCIAN",21],["FLAGA",18],["WAWEL",12],["TATRY",7]]},
            {q:"Przedmiot szkolny", a:[["ZESZYT",41],["PI√ìRNIK",23],["PODRƒòCZNIK",16],["TABLICA",11]]},
            {q:"Kwiat ciƒôty do wazonu", a:[["R√ì≈ªA",52],["TULIPAN",20],["GO≈πDZIK",12],["GERBERA",6]]},
            {q:"Co≈õ s≈Çodkiego do jedzenia", a:[["CZEKOLADA",39],["CIASTKO",26],["CUKIERKI",18],["LODY",11]]},
            {q:"Marka samochodu", a:[["FIAT",30],["BMW",25],["MERCEDES",20],["AUDI",15]]},
            {q:"Dzie≈Ñ tygodnia (opr√≥cz pon.)", a:[["SOBOTA",35],["PIƒÑTEK",28],["NIEDZIELA",20],["≈öRODA",10]]},
            {q:"Gdzie spƒôdzamy urlop?", a:[["NAD MORZEM",50],["W G√ìRACH",25],["ZA GRANICƒÑ",15],["W LESIE",5]]},
            {q:"Czym piszemy?", a:[["D≈ÅUGOPIS",58],["O≈Å√ìWEK",18],["PI√ìRO",14],["KREDA",5]]},
            {q:"Co≈õ czerwonego", a:[["POMIDOR",36],["KREW",24],["R√ì≈ªA",18],["STRA≈ª PO≈ªARNA",10]]},
            {q:"Ptak, kt√≥ry nie lata", a:[["STRU≈ö",48],["PINGWIN",35],["KURA",12]]},
            {q:"Mebel w salonie", a:[["KANAPA",42],["FOTEL",21],["ST√ì≈Å",18],["REGA≈Å",11]]},
            {q:"Pojazd bez silnika", a:[["ROWER",55],["HULAJNOGA",20],["W√ìZEK",15],["SANKI",6]]},
            {q:"Owoc egzotyczny", a:[["BANAN",44],["ANANAS",22],["KIWI",15],["POMARA≈ÉCZA",11]]},
            {q:"Co≈õ, co ma ko≈Ça", a:[["SAMOCH√ìD",50],["ROWER",25],["POCIƒÑG",15],["W√ìZEK",6]]},
            {q:"Instrument klawiszowy", a:[["PIANINO",49],["FORTEPIAN",26],["ORGAN",15],["AKORDEON",6]]},
            {q:"Ryba na wigiliƒô", a:[["KARP",75],["≈öLED≈π",15],["PSTRƒÑG",5]]},
            {q:"Gdzie szukamy grzyb√≥w?", a:[["W LESIE",85],["W MCHU",10],["NA TARGU",5]]},
            {q:"Co ma li≈õcie?", a:[["DRZEWO",58],["KWIAT",22],["KSIƒÑ≈ªKA",12],["KAPUSTA",6]]},
            {q:"P≈Çyn do picia", a:[["WODA",45],["SOK",25],["HERBATA",15],["KAWA",10]]},
            {q:"Dyscyplina sportowa z pi≈ÇkƒÖ", a:[["PI≈ÅKA NO≈ªNA",60],["SIATK√ìWKA",20],["KOSZYK√ìWKA",12]]},
            {q:"Pa≈Ñstwo sƒÖsiadujƒÖce z PolskƒÖ", a:[["NIEMCY",48],["CZECHY",20],["S≈ÅOWACJA",15],["UKRAINA",10]]},
            {q:"Co≈õ co ≈õwieci", a:[["S≈ÅO≈ÉCE",46],["≈ªAR√ìWKA",28],["KSIƒò≈ªYC",15],["LATARKA",7]]},
            {q:"Metal szlachetny", a:[["Z≈ÅOTO",65],["SREBRO",25],["PLATYNA",8]]},
            {q:"Co k≈Çadziemy na chleb?", a:[["MAS≈ÅO",44],["SZYNKA",26],["SER",18],["D≈ªEM",8]]},
            {q:"Postaƒá z bajki", a:[["MYSZKA MICKEY",30],["KOPCIUSZEK",22],["SHREK",18],["BOLEK I LOLEK",12]]},
            {q:"W czym nosimy zakupy?", a:[["TORBA",52],["REKLAM√ìWKA",24],["KOSZYK",18],["PLECAK",4]]},
            {q:"Co≈õ zimnego", a:[["L√ìD",49],["≈öNIEG",26],["WODA",15],["PIWO",8]]},
            {q:"Czƒô≈õƒá twarzy", a:[["NOS",41],["OCZY",29],["USTA",18],["USZY",8]]},
            {q:"MiesiƒÖc letni", a:[["LIPIEC",45],["SIERPIE≈É",35],["CZERWIEC",20]]},
            {q:"Co≈õ co ma zƒôby", a:[["GRZEBIE≈É",38],["CZ≈ÅOWIEK",24],["PI≈ÅA",18],["REKIN",12]]},
            {q:"Zwierzƒô domowe (nie pies/kot)", a:[["CHOMIK",42],["KR√ìLIK",28],["≈öWINKA MORSKA",18],["PAPA_UGA",8]]},
            {q:"Co≈õ, co tyka", a:[["ZEGAR",65],["BOMBA",25],["SERCE",8]]},
            {q:"Gdzie trzymamy pieniƒÖdze?", a:[["W BANKU",48],["W PORTFELU",35],["W SKARPECIE",12]]},
            {q:"Zaw√≥d w mundurze", a:[["POLICJANT",45],["STRA≈ªAK",30],["≈ªO≈ÅNIERZ",20],["PILOT",4]]},
            {q:"Co ro≈õnie w ogrodzie?", a:[["KWIATY",42],["WARZYWA",28],["TRAWA",18],["DRZEWA",8]]},
            {q:"≈örodek transportu miejskiego", a:[["AUTOBUS",55],["TRAMWAJ",30],["METRO",12]]},
            {q:"Co≈õ co lata", a:[["SAMOLOT",48],["PTAK",32],["MUCHA",15]]},
            {q:"Co ma klucze?", a:[["ZAMEK",44],["FORTEPIAN",26],["WO≈πNY",18]]},
            {q:"W co gramy?", a:[["W KARTY",40],["W PI≈ÅKƒò",30],["W SZACHY",18],["W GRY",10]]},
            {q:"Atrybut lekarza", a:[["STETOSKOP",52],["FARTUCH",24],["STRZYKAWKA",18]]}
        ];

        const F_SETS = [
            ["1. Ro≈õlina k≈ÇujƒÖca", "2. Marka samochodu", "3. Czƒô≈õƒá roweru", "4. Miasto w Polsce", "5. Imiƒô mƒôskie na A"],
            ["1. Co≈õ s≈Çodkiego", "2. Instrument muzyczny", "3. Drzewo li≈õciaste", "4. Pa≈Ñstwo w Europie", "5. Co≈õ czerwonego"],
            ["1. Sport zimowy", "2. Ptak drapie≈ºny", "3. Mebel w salonie", "4. P≈Çyn do picia", "5. Zaw√≥d medyczny"],
            ["1. Co≈õ co parzy", "2. Czƒô≈õƒá twarzy", "3. Ryba s≈Çodkowodna", "4. Imiƒô ≈ºe≈Ñskie na M", "5. Planeta"],
            ["1. Co≈õ okrƒÖg≈Çego", "2. Stolica pa≈Ñstwa", "3. Narzƒôdzie warsztatowe", "4. Warzywo zielone", "5. Ptak domowy"],
            ["1. Co≈õ do pisania", "2. Marka opon", "3. Gra zespo≈Çowa", "4. Miasto nad morzem", "5. Przyprawa"],
            ["1. Co≈õ co ≈õwieci", "2. Kr√≥l Polski", "3. Pasmo g√≥rskie", "4. Owoc cytrusowy", "5. Nap√≥j alkoholowy"],
            ["1. Co ma ko≈Ça", "2. Bohater bajki", "3. Waluta", "4. Sport walki", "5. Instrument dƒôty"],
            ["1. Co≈õ co tyka", "2. Gatunek muzyki", "3. Drzewo iglaste", "4. Rzeka w Polsce", "5. Owad"],
            ["1. Co≈õ zimnego", "2. Jƒôzyk obcy", "3. Element komputera", "4. Kwiat wiosenny", "5. Czƒô≈õƒá nogi"]
        ];

        let peer = new Peer(), conn, sum=0, activeSide='L';

        function connect() { 
            conn = peer.connect(document.getElementById('tv-id').value); 
            conn.on('open', () => document.getElementById('tv-id').style.borderColor = 'green');
        }

        function toggleSide() { 
            activeSide = activeSide === 'L' ? 'R' : 'L'; 
            document.getElementById('side-btn').innerText = 'STRONA: ' + (activeSide === 'L' ? 'LEWA' : 'PRAWA');
        }

        window.onload = () => {
            const s = document.getElementById('q-select');
            DB.forEach((x,i) => s.innerHTML += `<option value="${i}">${i+1}. ${x.q}</option>`);
            
            const fs = document.getElementById('f-set-select');
            F_SETS.forEach((x,i) => fs.innerHTML += `<option value="${i}">ZESTAW FINA≈ÅOWY ${i+1}</option>`);

            const fi = document.getElementById('f-inputs');
            ['p1','p2'].forEach(p => {
                fi.innerHTML += `<div style="color:#e2ff00; font-size:12px; margin:10px 0 5px 0">${p==='p1'?'GRACZ 1':'GRACZ 2'}</div>`;
                for(let i=0; i<5; i++) {
                    fi.innerHTML += `<div style="display:flex;gap:2px"><input id="f-${p}-t-${i}" placeholder="Odp" style="font-size:10px"><input id="f-${p}-p-${i}" type="number" style="width:40px"><button onclick="revF('${p}',${i})" style="width:35px; background:#e2ff00; color:black">OK</button></div>`;
                }
            });
            showFHints(); previewQ();
        };

        function showFHints() { document.getElementById('f-hints').innerHTML = F_SETS[document.getElementById('f-set-select').value].join("<br>"); }
        function sendQ() { sum=0; updateS(); const q=DB[document.getElementById('q-select').value]; send({type:'SETUP_NORMAL', ans: q.a.map(x=>({t:x[0], p:x[1]}))}); previewQ(); }
        function previewQ() { const q=DB[document.getElementById('q-select').value]; document.getElementById('ans-preview').innerHTML = q.a.map((x,i) => `<button class="ans-preview-btn" onclick="revN(${i},${x[1]})">${x[0]} (${x[1]})</button>`).join(''); }
        function revN(i,p) { sum+=p; updateS(); send({type:'REV_NORMAL', idx:i}); send({type:'SCORE', val:sum}); }
        function revF(p,i) { const t=document.getElementById(`f-${p}-t-${i}`).value.toUpperCase(), pts=parseInt(document.getElementById(`f-${p}-p-${i}`).value)||0; sum+=pts; updateS(); send({type:'REV_FINAL', player:p, idx:i, t:t, p:pts}); send({type:'SCORE', val:sum}); }
        function updateS() { document.getElementById('current-sum').innerText = sum; }
        function sendX(n) { send({type:'X', side:activeSide, n:n}); }
        function runTimer(s) { let c=s; send({type:'TIMER', action:'start', val:c}); let itv=setInterval(()=>{ c--; send({type:'TIMER', action:'tick', val:c}); if(c<=0){ clearInterval(itv); send({type:'TIMER', action:'stop'}); } }, 1000); }
        function send(d) { if(conn) conn.send(d); }
    </script>
</body>
</html>
