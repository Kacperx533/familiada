<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #111; color: white; font-family: sans-serif; padding: 20px; }
        .card { background: #222; padding: 15px; margin: 10px; border-radius: 10px; border: 1px solid #444; }
        button { padding: 10px; margin: 5px; cursor: pointer; font-weight: bold; border: none; border-radius: 5px; background: #444; color: white; }
        .gold { background: gold !important; color: black !important; } 
        .red { background: #ff4444 !important; } 
        .blue { background: #4444ff !important; }
        .score { font-size: 32px; color: gold; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 5px; }
    </style>
</head>
<body>
    <div class="card">
        <input type="text" id="id" placeholder="KOD Z TV">
        <button class="gold" onclick="connect()">PO≈ÅƒÑCZ Z TV</button>
    </div>

    <div class="card">
        <button class="gold" onclick="s({type:'INTRO'})">üé¨ START (CZO≈Å√ìWKA)</button>
        <button onclick="s({type:'SOUND', name:'pow'})" class="red">‚ö†Ô∏è POWT√ìRZENIE (FINA≈Å)</button>
    </div>

    <div class="card">
        <div class="score">A: <span id="ptsA">0</span> | B: <span id="ptsB">0</span></div>
        <p>Punkty do dodania: <input type="number" id="manualPts" style="width:60px"></p>
        <button class="red" onclick="add('A')">DODAJ DLA A</button>
        <button class="blue" onclick="add('B')">DODAJ DLA B</button>
        <button onclick="resetS()">ZERUJ MECZ</button>
    </div>

    <div class="card">
        <button class="red" onclick="str('A')">B≈ÅƒÑD A (X)</button>
        <button class="blue" onclick="str('B')">B≈ÅƒÑD B (X)</button>
        <button onclick="resetX()">USU≈É X</button>
    </div>

    <div class="card">
        <h3>WYBIERZ PYTANIE:</h3>
        <div class="grid" id="question-list"></div>
        <hr>
        <div id="btns"></div>
    </div>

    <script>
        let peer = new Peer(), conn, sA=0, sB=0, stA=0, stB=0, rSum=0;

        const baza = [
            {q:"Przedmiot szkolny", a:[{t:'MATEMATYKA',p:45},{t:'POLSKI',p:30},{t:'WF',p:15},{t:'HISTORIA',p:10}]},
            {q:"Na przerwie", a:[{t:'TELEFON',p:50},{t:'JEDZENIE',p:25},{t:'ROZMOWA',p:15},{t:'≈öCIƒÑGANIE',p:10}]},
            {q:"W pi√≥rniku", a:[{t:'D≈ÅUGOPIS',p:55},{t:'O≈Å√ìWEK',p:20},{t:'GUMKA',p:15},{t:'LINIJKKA',p:10}]},
            {q:"Sp√≥≈∫nienie", a:[{t:'ZASPANIE',p:60},{t:'KOREK',p:20},{t:'AUTOBUS',p:15},{t:'POGODA',p:5}]},
            {q:"W plecaku", a:[{t:'KSIƒÑ≈ªKI',p:40},{t:'KANAPKI',p:30},{t:'WODA',p:20},{t:'S≈ÅUCHAWKI',p:10}]},
            {q:"Ulubiony dzie≈Ñ", a:[{t:'PIƒÑTEK',p:65},{t:'SOBOTA',p:25},{t:'NIEDZIELA',p:10}]},
            {q:"Gdzie na wycieczkƒô?", a:[{t:'G√ìRY',p:45},{t:'MORZE',p:35},{t:'KINO',p:15},{t:'BASEN',p:5}]},
            {q:"Co jest w bufecie?", a:[{t:'DRO≈ªD≈ª√ìWKA',p:50},{t:'PICIE',p:25},{t:'OWOC',p:15},{t:'BATON',p:10}]},
            {q:"Sport szkolny", a:[{t:'NOGA',p:55},{t:'SIATKA',p:25},{t:'KOSZ',p:20}]},
            {q:"Ocena (slang)", a:[{t:'KOSA',p:50},{t:'BANIA',p:30},{t:'SZMATA',p:20}]}
        ];

        function connect() { conn = peer.connect(document.getElementById('id').value); conn.on('open', () => alert("PO≈ÅƒÑCZONO!")); }
        function s(m) { if(conn) conn.send(m); }
        function str(t) { if(t==='A') stA++; else stB++; s({type:'STRIKE', team:t, count:(t==='A'?stA:stB)}); }
        function resetX() { stA=0; stB=0; s({type:'STRIKE', team:'A', count:0}); s({type:'STRIKE', team:'B', count:0}); }
        function add(t) { 
            let v = parseInt(document.getElementById('manualPts').value) || 0;
            if(t==='A') sA+=v; else sB+=v;
            document.getElementById('ptsA').innerText = sA; document.getElementById('ptsB').innerText = sB;
            document.getElementById('manualPts').value = "";
        }
        function loadQ(nr) {
            const d = baza[nr]; rSum = 0; resetX();
            s({type:'SETUP', ans:d.a}); s({type:'SYNC', rt:0});
            document.getElementById('btns').innerHTML = `<h4>${d.q}</h4>` + d.a.map((a,i)=>`<button onclick="rev(${i},${a.p})">${a.t} (${a.p})</button>`).join('');
        }
        function rev(i, p) { rSum+=p; document.getElementById('manualPts').value = rSum; s({type:'REVEAL', idx:i}); s({type:'SYNC', rt:rSum}); }
        function resetS() { sA=0; sB=0; document.getElementById('ptsA').innerText=0; document.getElementById('ptsB').innerText=0; }
        
        // Generuj listƒô pyta≈Ñ
        document.getElementById('question-list').innerHTML = baza.map((b,i)=>`<button onclick="loadQ(${i})">${i+1}. ${b.q}</button>`).join('');
    </script>
</body>
</html>
