<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 12px; border-top: 4px solid #ffcc00; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        button { padding: 12px; margin: 5px 0; width: 100%; cursor: pointer; font-weight: bold; border-radius: 6px; border: none; transition: 0.2s; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        .gold { background: #ffcc00; color: #000; } 
        .blue { background: #0055ff; color: white; } 
        .red { background: #ff0044; color: white; }
        .active { outline: 3px solid white; box-shadow: 0 0 15px rgba(255,255,255,0.4); }
        input, select { width: 100%; padding: 12px; margin: 8px 0; box-sizing: border-box; background: #000; color: #fff; border: 1px solid #333; border-radius: 6px; }
        h3 { margin-top: 0; color: #ffcc00; letter-spacing: 1px; font-size: 16px; }
        .ans-btn { background: #333; color: #ddd; text-align: left; padding-left: 15px; }
    </style>
</head>
<body>

    <div>
        <div class="card">
            <h3>1. SYNCHRONIZACJA</h3>
            <input type="text" id="tv-id" placeholder="Wklej ID z ekranu TV">
            <button class="gold" onclick="connect()">PO≈ÅƒÑCZ SYSTEM</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button onclick="send({type:'INTRO'})">üé¨ START (CZO≈Å√ìWKA)</button>
            <button style="background: orange;" onclick="send({type:'REPEAT'})">üîî POWT√ìRZENIE (D≈πWIƒòK)</button>
            <button onclick="send({type:'OUTRO'})">üìù KONIEC (NAPISY)</button>
        </div>

        <div class="card">
            <h3>3. PUNKTY I DRU≈ªYNY</h3>
            <div style="display:flex; gap:10px;">
                <button id="btn-a" class="blue" onclick="selTeam('A')">NIEBIESCY (LEWA)</button>
                <button id="btn-b" class="red" onclick="selTeam('B')">CZERWONI (PRAWA)</button>
            </div>
            <button class="red" style="margin-top:15px; font-size: 18px;" onclick="sendStrike()">‚ùå B≈ÅƒÑD (X)</button>
            <div style="text-align:center; font-size:32px; margin:20px 0; color: #ffcc00; border: 1px solid #333; padding: 10px;">SUMA RUNDY: <span id="s-r">0</span></div>
            <button class="gold" style="height: 60px; font-size: 18px;" onclick="addPts()">DODAJ PUNKTY DRU≈ªYNIE</button>
            <div style="display:flex; justify-content: space-around; margin-top: 10px;">
                <span>Pkt A: <b id="s-a">0</b></span>
                <span>Pkt B: <b id="s-b">0</b></span>
            </div>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>4. RUNDA I PYTANIA</h3>
            <select id="q-sel" onchange="preview()"></select>
            <button class="gold" style="height: 50px; margin-bottom: 15px;" onclick="sendSetup()">WY≈öLIJ PYTANIE NA TABLICƒò</button>
            <div id="ans-list"></div>
        </div>
    </div>

    <script>
        const db = [
            {q:"Przedmiot szkolny?", a:[["MATEMATYKA",45],["POLSKI",25],["WF",15],["HISTORIA",10],["BIOLOGIA",5]]},
            {q:"Co robimy na przerwie?", a:[["JEMY ≈öNIADANIE",40],["ROZMAWIAMY",30],["BIEGAMY",15],["POWTARZAMY",10],["TELEFON",5]]},
            {q:"Wyposa≈ºenie pi√≥rnika?", a:[["D≈ÅUGOPIS",50],["O≈Å√ìWEK",20],["GUMKA",15],["LINIJKA",10],["KREDKI",5]]},
            {q:"Co kojarzy siƒô z wakacjami?", a:[["MORZE",40],["S≈ÅO≈ÉCE",25],["LODY",20],["PIASEK",10],["G√ìRY",5]]},
            {q:"Zwierzƒô na literƒô K?", a:[["KOT",45],["KO≈É",25],["KROWA",15],["KANGUR",10],["KROKODYL",5]]},
            {q:"Co mo≈ºna dostaƒá od nauczyciela?", a:[["OCENƒò",48],["POCHWA≈Åƒò",22],["UWAGƒò",15],["ZADANIE",10],["PYTANIE",5]]}
        ];

        let peer = new Peer(), conn, scoreA=0, scoreB=0, scoreR=0, team='A';

        window.onload = () => {
            const sel = document.getElementById('q-sel');
            db.forEach((it, i) => sel.innerHTML += `<option value="${i}">${it.q}</option>`);
            preview(); selTeam('A');
        };

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => alert("PO≈ÅƒÑCZONO Z TABLICƒÑ!"));
        }

        function send(d) { if(conn) conn.send(d); }

        function preview() {
            const data = db[document.getElementById('q-sel').value];
            const div = document.getElementById('ans-list'); div.innerHTML = "";
            data.a.forEach((ans, i) => {
                div.innerHTML += `<button class="ans-btn" onclick="reveal(${i}, ${ans[1]})">${ans[0]} (${ans[1]})</button>`;
            });
        }

        function sendSetup() {
            scoreR = 0; updateUI();
            const data = db[document.getElementById('q-sel').value];
            send({type:'SETUP_ROUND', answers: data.a.map(x=>({text:x[0], points:x[1]}))});
        }

        function reveal(idx, pts) {
            scoreR += pts; updateUI();
            send({type:'REVEAL', idx:idx});
            sync();
        }

        function sendStrike() { send({type:'STRIKE', team: team}); }

        function selTeam(t) {
            team = t;
            document.getElementById('btn-a').classList.toggle('active', t==='A');
            document.getElementById('btn-b').classList.toggle('active', t==='B');
        }

        function addPts() {
            if(team==='A') scoreA += scoreR; else scoreB += scoreR;
            scoreR = 0; updateUI(); sync();
        }

        function updateUI() {
            document.getElementById('s-a').innerText = scoreA;
            document.getElementById('s-b').innerText = scoreB;
            document.getElementById('s-r').innerText = scoreR;
        }

        function sync() { send({type:'SCORE', r:scoreR, t:scoreA+scoreB}); }
    </script>
</body>
</html>
