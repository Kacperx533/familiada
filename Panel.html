<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>FAMILIADA - PANEL STEROWANIA ULTIMATE</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: #e0e0e0; padding: 20px; margin: 0; }
        .container { max-width: 900px; margin: 0 auto; }
        .card { background: #1e1e1e; border: 1px solid #333; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        h3 { color: #f5b041; margin-top: 0; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; background: #3d3d3d; color: #fff; }
        button:hover { background: #555; }
        
        .btn-gold { background: #f5b041; color: #000; }
        .btn-red { background: #e74c3c; color: #fff; }
        .btn-active { outline: 3px solid #f5b041; background: #555; }
        
        input, select { width: 100%; padding: 12px; background: #000; color: #fff; border: 1px solid #444; border-radius: 6px; box-sizing: border-box; margin-bottom: 10px; font-size: 16px; }
        
        .ans-item { display: flex; justify-content: space-between; align-items: center; background: #252525; padding: 10px; margin-bottom: 5px; border-radius: 4px; border-left: 4px solid #f5b041; }
        .multiplier-info { background: #f5b041; color: #000; padding: 5px 10px; border-radius: 4px; font-weight: bold; margin-bottom: 10px; display: inline-block; }
    </style>
</head>
<body>

<div class="container">
    <div class="card" id="conn-section">
        <h3>1. Po≈ÇƒÖczenie</h3>
        <input type="text" id="target-id" placeholder="WPISZ KOD Z EKRANU TV">
        <button class="btn-gold" onclick="connect()" style="width: 100%">PO≈ÅƒÑCZ Z TELEWIZOREM</button>
    </div>

    <div id="controls" style="display:none">
        <div class="card">
            <h3>2. Multimedia i Rundy</h3>
            <div class="grid">
                <button onclick="s({type:'VIDEO', file:'czolowka.mp4'})">üé¨ CZO≈Å√ìWKA</button>
                <button onclick="s({type:'VIDEO', file:'napisy.mp4'})">üé¨ NAPISY</button>
                <button id="m1" class="btn-active" onclick="setMult(1)">RUNDA x1</button>
                <button id="m2" onclick="setMult(2)">RUNDA x2</button>
                <button id="m3" onclick="setMult(3)">RUNDA x3</button>
                <button class="btn-gold" onclick="alert('Tryb Fina≈Çowy: U≈ºyj pyta≈Ñ poni≈ºej')">TRYB FINA≈Å</button>
            </div>
        </div>

        <div class="card">
            <h3>3. Wyb√≥r Pytania</h3>
            <div class="multiplier-info" id="mult-display">AKTYWNY MNO≈ªNIK: x1</div>
            <select id="q-select" onchange="renderQuestion()"></select>
            <button class="btn-gold" onclick="sendToTV()" style="width: 100%; margin-bottom: 15px;">WY≈öLIJ PYTANIE NA TABLICƒò</button>
            <div id="ans-preview"></div>
        </div>

        <div class="card">
            <h3>4. ZarzƒÖdzanie Wynikiem</h3>
            <div class="grid">
                <button class="btn-red" onclick="s({type:'STRIKE'})">‚ùå B≈ÅƒÑD (X)</button>
                <button onclick="s({type:'VIDEO', file:'zle.mp3'})">üîä D≈πWIƒòK B≈ÅƒòDU</button>
            </div>
            <div class="grid" style="margin-top: 15px;">
                <div>
                    <label>DRU≈ªYNA A</label>
                    <input type="number" id="pts-a" value="0" onchange="syncPts()">
                </div>
                <div>
                    <label>DRU≈ªYNA B</label>
                    <input type="number" id="pts-b" value="0" onchange="syncPts()">
                </div>
            </div>
            <button onclick="syncPts()" style="width: 100%; margin-top: 10px;">AKTUALIZUJ SUMƒò NA TV</button>
        </div>
    </div>
</div>

<script>
    const database = [
        {q:"Wiƒôcej ni≈º jedno zwierzƒô?", a:[["OWCE",41],["LAMY",28],["BYD≈ÅO",15],["WATAHA",8],["STADO",5],["MR√ìWKI",3]]},
        {q:"Co mo≈ºna robiƒá w lesie?", a:[["SPACEROWAƒÜ",45],["ZBIERAƒÜ GRZYBY",32],["BIEGAƒÜ",12],["JE≈πDZIƒÜ ROWEREM",6],["ODPOCZYWAƒÜ",5]]},
        {q:"Przedmiot szkolny?", a:[["MATEMATYKA",48],["J. POLSKI",25],["HISTORIA",12],["WF",8],["GEOGRAFIA",7]]},
        {q:"Zimowy sport?", a:[["NARCIARSTWO",52],["≈ÅY≈ªWIARSTWO",24],["SKOKI NARCIARSKIE",15],["HOKEJ",6],["SANKI",3]]},
        {q:"Co pijemy na ≈õniadanie?", a:[["HERBATA",38],["KAWA",31],["KAKAO",15],["SOK",9],["MLEKO",7]]},
        {q:"Danie z jajek?", a:[["JAJECZNICA",65],["OMLET",18],["JAJKO SADZONE",12],["JAJKO NA MIƒòKKO",5]]},
        {q:"Zwierzƒô domowe?", a:[["PIES",50],["KOT",35],["CHOMIK",8],["PAPUGA",4],["RYBKI",3]]},
        {q:"S≈Çodki owoc?", a:[["TRUSKAWKA",35],["BANAN",28],["JAB≈ÅKO",20],["MALINA",12],["GRUSZKA",5]]},
        {q:"Co ro≈õnie w ogrodzie?", a:[["KWIATY",42],["TRAWA",25],["WARZYWA",18],["DRZEWA OWOCOWE",10],["KRZEWY",5]]},
        {q:"Marka samochodu?", a:[["VOLKSWAGEN",35],["TOYOTA",28],["BMW",15],["MERCEDES",12],["AUDI",10]]},
        {q:"Co znajdziemy w kuchni?", a:[["LOD√ìWKA",40],["KUCHENKA",30],["TALERZE",15],["SZTUƒÜCE",10],["GARNKI",5]]},
        {q:"Stolica kraju w Europie?", a:[["WARSZAWA",45],["PARY≈ª",25],["BERLIN",15],["RZYM",10],["PRAGA",5]]},
        {q:"Gdzie spƒôdzamy wakacje?", a:[["NAD MORZEM",50],["W G√ìRACH",30],["NA MAZURACH",12],["ZA GRANICƒÑ",8]]},
        {q:"Zaw√≥d medyczny?", a:[["LEKARZ",55],["PIELƒòGNIARKA",25],["RATOWNIK",12],["DENTYSTA",8]]},
        {q:"Co k≈Çadziemy na kanapkƒô?", a:[["SER",40],["SZYNKA",35],["POMIDOR",15],["MAS≈ÅO",10]]},
        {q:"Instrument muzyczny?", a:[["GITARA",38],["PIANINO",32],["SKRZYPCE",15],["PERKUSJA",10],["FLET",5]]},
        {q:"Dyscyplina lekkoatletyczna?", a:[["BIEG",45],["SKOK W DAL",25],["RZUT OSZCZEPEM",15],["PCHNIƒòCIE KULƒÑ",10],["SKOK WZWY≈ª",5]]},
        {q:"W czym trzymamy pieniƒÖdze?", a:[["PORTFEL",55],["BANK",25],["SKARBONKA",15],["KIESZE≈É",5]]},
        {q:"Z czym mo≈ºna je≈õƒá nale≈õniki?", a:[["D≈ªEM",42],["SER",30],["NUTELLA",20],["OWOCE",8]]},
        {q:"Zjawisko pogodowe?", a:[["DESZCZ",40],["BURZA",28],["≈öNIEG",15],["WIATR",12],["MG≈ÅA",5]]}
    ];

    let peer = new Peer(), conn;
    let multiplier = 1;
    let roundPoints = 0;

    window.onload = () => {
        const sel = document.getElementById('q-select');
        database.forEach((item, i) => {
            const opt = document.createElement('option');
            opt.value = i;
            opt.innerText = item.q;
            sel.appendChild(opt);
        });
        renderQuestion();
    };

    function connect() {
        const id = document.getElementById('target-id').value;
        conn = peer.connect(id);
        conn.on('open', () => {
            document.getElementById('conn-section').style.display = 'none';
            document.getElementById('controls').style.display = 'block';
        });
    }

    function s(m) { if(conn) conn.send(m); }

    function setMult(m) {
        multiplier = m;
        document.querySelectorAll('[id^="m"]').forEach(b => b.classList.remove('btn-active'));
        document.getElementById('m'+m).classList.add('btn-active');
        document.getElementById('mult-display').innerText = "AKTYWNY MNO≈ªNIK: x" + m;
    }

    function renderQuestion() {
        const idx = document.getElementById('q-select').value;
        const qData = database[idx];
        const preview = document.getElementById('ans-preview');
        preview.innerHTML = "";
        
        qData.a.forEach((ans, i) => {
            preview.innerHTML += `
                <div class="ans-item">
                    <span>${ans[0]} (${ans[1]})</span>
                    <button class="btn-gold" onclick="reveal(${i}, ${ans[1]})">ODS≈ÅO≈É</button>
                </div>
            `;
        });
    }

    function sendToTV() {
        const idx = document.getElementById('q-select').value;
        const qData = database[idx];
        roundPoints = 0;
        s({
            type: 'SETUP',
            ans: qData.a.map(x => ({ t: x[0], p: x[1] }))
        });
        syncPts();
    }

    function reveal(idx, pts) {
        roundPoints += (pts * multiplier);
        s({ type: 'REVEAL', idx: idx });
        syncPts();
    }

    function syncPts() {
        const ga = parseInt(document.getElementById('pts-a').value) || 0;
        const gb = parseInt(document.getElementById('pts-b').value) || 0;
        s({
            type: 'SYNC',
            rt: roundPoints,
            gt: ga + gb
        });
    }
</script>
</body>
</html>
