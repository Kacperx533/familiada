<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; display: grid; grid-template-columns: 320px 1fr 320px; gap: 15px; padding: 15px; }
        .card { background: #1e1e1e; padding: 12px; border-radius: 8px; border-top: 4px solid #e2ff00; margin-bottom: 10px; }
        button { width: 100%; padding: 10px; margin: 3px 0; cursor: pointer; font-weight: bold; border-radius: 4px; border: none; background: #333; color: white; }
        button:disabled { opacity: 0.2; cursor: not-allowed; }
        .btn-gold { background: #e2ff00; color: black; }
        .btn-red { background: #ff3333; }
        .btn-blue { background: #2196F3; }
        .btn-active-team { background: #4CAF50 !important; color: white; box-shadow: 0 0 10px #4CAF50; }
        .score-box { font-size: 24px; text-align: center; background: #000; color: #e2ff00; padding: 8px; margin: 5px 0; border: 1px solid #333; }
        input, select { width: 100%; padding: 8px; background: #000; color: white; border: 1px solid #444; margin-bottom: 8px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; }
        .scroll { height: 280px; overflow-y: auto; border: 1px solid #333; padding: 5px; background: #000; }
        h3 { color: #e2ff00; font-size: 13px; margin: 0 0 10px 0; text-transform: uppercase; }
    </style>
</head>
<body>
    <div>
        <div class="card"><h3>SYSTEM</h3><input id="tv-id" placeholder="ID z TV"><button class="btn-gold" onclick="connect()">PO≈ÅƒÑCZ</button></div>
        <div class="card">
            <h3>PUNKTY DRU≈ªYN (PANEL)</h3>
            <div class="grid">
                <button id="team1-btn" onclick="selectTeam(1, 'L')">DRU≈ªYNA 1 (L)</button>
                <button id="team2-btn" onclick="selectTeam(2, 'R')">DRU≈ªYNA 2 (P)</button>
            </div>
            <div id="t1-pts" style="font-size:18px; margin-top:10px">D1: 0 pkt</div>
            <button class="btn-blue control" onclick="addPts(1)" disabled>DODAJ SUMƒò DO D1</button>
            <div id="t2-pts" style="font-size:18px; margin-top:10px">D2: 0 pkt</div>
            <button class="btn-blue control" onclick="addPts(2)" disabled>DODAJ SUMƒò DO D2</button>
        </div>
        <div class="card">
            <h3>MEDIA</h3>
            <button class="btn-gold" onclick="send({type:'PLAY_MEDIA', video:'czolowka.mp4'})">üé¨ CZO≈Å√ìWKA</button>
            <button onclick="send({type:'PLAY_MEDIA', audio:'intro'})">üéµ INTRO MUZYKA</button>
            <button class="btn-red" onclick="send({type:'STOP_VIDEO'})">STOP WIDEO</button>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>RUNDY</h3>
            <div class="grid">
                <button onclick="startR(1)">RUNDA 1</button><button onclick="startR(2)">RUNDA 2</button>
                <button onclick="startR(3)">RUNDA 3</button><button onclick="startR(4)">RUNDA 4</button>
            </div>
        </div>
        <div class="card">
            <h3>PYTANIA RUNDY</h3>
            <select id="q-sel" onchange="preQ()"></select>
            <button class="btn-gold" onclick="sendQ()">ZA≈ÅADUJ NA TV</button>
            <div id="ans-pre" class="scroll"></div>
            <div class="score-box">SUMA RUNDY: <span id="cur-sum">0</span></div>
            <div class="grid">
                <button class="btn-red control" onclick="sendX(1)" disabled>B≈ÅƒÑD X</button>
                <button class="btn-red control" onclick="sendX(3)" disabled>B≈ÅƒÑD XXX</button>
                <button onclick="send({type:'PLAY_MEDIA', audio:'bad'})" style="background:#a00">üîä TYLKO D≈πWIƒòK (ZLE)</button>
                <button onclick="send({type:'PLAY_MEDIA', audio:'powtorzenie'})" style="background:#555">üîÑ POWT√ìRZENIE</button>
            </div>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>FINA≈Å</h3>
            <button class="btn-gold" onclick="send({type:'SETUP_FINAL'});send({type:'PLAY_MEDIA',video:'final.mp4'})">START FINA≈ÅU</button>
            <div class="grid"><button onclick="runT(15)">15s</button><button onclick="runT(20)">20s</button></div>
            <select id="f-sel" onchange="showFH()"></select>
            <div id="f-h" style="font-size:11px; color:#888; margin:10px 0"></div>
            <div id="f-ins" class="scroll"></div>
        </div>
    </div>

    <script>
        const DB = [
            {q:"Wiƒôcej ni≈º jedno zwierzƒô", a:[["STADO",52],["KLUCZ",17],["WATAHA",11],["≈ÅAWICA",8],["SFORA",5]]},
            {q:"Co≈õ co parzy", a:[["POKRZYWA",38],["OGIE≈É",31],["WRZƒÑTEK",19],["S≈ÅO≈ÉCE",7],["MEDUZA",3]]},
            {q:"Zwierzƒô na literƒô P", a:[["PIES",44],["PTAK",18],["PANDA",12],["PCH≈ÅA",6],["PAW",4]]},
            {q:"Przedmiot w kuchni na T", a:[["TALERZ",45],["TARKA",21],["TOSTER",11],["TEFLON",6]]},
            {q:"Co robimy rano?", a:[["MYJEMY SIƒò",35],["PIJEMY KAWƒò",24],["≈öNIADANIE",19],["UBIERANIE",12],["≈öCIELENIE",5]]},
            {q:"Czƒô≈õƒá garderoby na zimƒô", a:[["CZAPKA",40],["SZALIK",22],["RƒòKAWICZKI",17],["KURTKA",13],["KO≈ªUCH",4]]},
            {q:"Sk≈Çadnik pizzy", a:[["SER",55],["SZYNKA",15],["PIECZARKI",12],["SOS",9],["CEBULA",4]]},
            {q:"Dyscyplina lekkoatletyczna", a:[["BIEG",48],["SKOK W DAL",19],["RZUT OSZCZEPEM",11],["PCHNIƒòCIE KULƒÑ",7]]},
            {q:"Co mo≈ºna otworzyƒá?", a:[["OKNO",39],["DRZWI",29],["BUTELKƒò",14],["OCZY",10],["KONTO",4]]},
            {q:"Zwierzƒô wiejskie", a:[["KURA",43],["KROWA",21],["≈öWINIA",16],["KACZKA",9],["KO≈É",6]]},
            {q:"Co kojarzy siƒô z PolskƒÖ?", a:[["PIEROGI",35],["BOCIAN",21],["FLAGA",18],["WAWEL",12],["TATRY",7]]},
            {q:"Przedmiot szkolny", a:[["ZESZYT",41],["PI√ìRNIK",23],["PODRƒòCZNIK",16],["TABLICA",11]]},
            {q:"Kwiat ciƒôty do wazonu", a:[["R√ì≈ªA",52],["TULIPAN",20],["GO≈πDZIK",12],["GERBERA",6]]},
            {q:"Co≈õ s≈Çodkiego do jedzenia", a:[["CZEKOLADA",39],["CIASTKO",26],["CUKIERKI",18],["LODY",11]]},
            {q:"Marka samochodu", a:[["FIAT",30],["BMW",25],["MERCEDES",20],["AUDI",15]]},
            {q:"Dzie≈Ñ tygodnia (opr√≥cz pon.)", a:[["SOBOTA",35],["PIƒÑTEK",28],["NIEDZIELA",20],["≈öRODA",10]]},
            {q:"Gdzie spƒôdzamy urlop?", a:[["NAD MORZEM",50],["W G√ìRACH",25],["ZA GRANICƒÑ",15],["W LESIE",5]]},
            {q:"Czym piszemy?", a:[["D≈ÅUGOPIS",58],["O≈Å√ìWEK",18],["PI√ìRO",14],["KREDA",5]]},
            {q:"Co≈õ czerwonego", a:[["POMIDOR",36],["KREW",24],["R√ì≈ªA",18],["STRA≈ª PO≈ªARNA",10]]},
            {q:"Ptak, kt√≥ry nie lata", a:[["STRU≈ö",48],["PINGWIN",35],["KURA",12]]},
            {q:"Mebel w salonie", a:[["KANAPA",42],["FOTEL",21],["ST√ì≈Å",18],["REGA≈Å",11]]},
            {q:"Pojazd bez silnika", a:[["ROWER",55],["HULAJNOGA",20],["W√ìZEK",15],["SANKI",6]]},
            {q:"Owoc egzotyczny", a:[["BANAN",44],["ANANAS",22],["KIWI",15],["POMARA≈ÉCZA",11]]},
            {q:"Co≈õ, co ma ko≈Ça", a:[["SAMOCH√ìD",50],["ROWER",25],["POCIƒÑG",15],["W√ìZEK",6]]},
            {q:"Instrument klawiszowy", a:[["PIANINO",49],["FORTEPIAN",26],["ORGAN",15],["AKORDEON",6]]},
            {q:"Ryba na wigiliƒô", a:[["KARP",75],["≈öLED≈π",15],["PSTRƒÑG",5]]},
            {q:"Gdzie szukamy grzyb√≥w?", a:[["W LESIE",85],["W MCHU",10],["NA TARGU",5]]},
            {q:"Co ma li≈õcie?", a:[["DRZEWO",58],["KWIAT",22],["KSIƒÑ≈ªKA",12],["KAPUSTA",6]]},
            {q:"P≈Çyn do picia", a:[["WODA",45],["SOK",25],["HERBATA",15],["KAWA",10]]},
            {q:"Dyscyplina sportowa z pi≈ÇkƒÖ", a:[["PI≈ÅKA NO≈ªNA",60],["SIATK√ìWKA",20],["KOSZYK√ìWKA",12]]},
            {q:"Pa≈Ñstwo sƒÖsiadujƒÖce z PolskƒÖ", a:[["NIEMCY",48],["CZECHY",20],["S≈ÅOWACJA",15],["UKRAINA",10]]},
            {q:"Co≈õ co ≈õwieci", a:[["S≈ÅO≈ÉCE",46],["≈ªAR√ìWKA",28],["KSIƒò≈ªYC",15],["LATARKA",7]]},
            {q:"Metal szlachetny", a:[["Z≈ÅOTO",65],["SREBRO",25],["PLATYNA",8]]},
            {q:"Co k≈Çadziemy na chleb?", a:[["MAS≈ÅO",44],["SZYNKA",26],["SER",18],["D≈ªEM",8]]},
            {q:"Postaƒá z bajki", a:[["MYSZKA MICKEY",30],["KOPCIUSZEK",22],["SHREK",18],["BOLEK I LOLEK",12]]},
            {q:"W czym nosimy zakupy?", a:[["TORBA",52],["REKLAM√ìWKA",24],["KOSZYK",18],["PLECAK",4]]},
            {q:"Co≈õ zimnego", a:[["L√ìD",49],["≈öNIEG",26],["WODA",15],["PIWO",8]]},
            {q:"Czƒô≈õƒá twarzy", a:[["NOS",41],["OCZY",29],["USTA",18],["USZY",8]]},
            {q:"MiesiƒÖc letni", a:[["LIPIEC",45],["SIERPIE≈É",35],["CZERWIEC",20]]},
            {q:"Co≈õ co ma zƒôby", a:[["GRZEBIE≈É",38],["CZ≈ÅOWIEK",24],["PI≈ÅA",18],["REKIN",12]]},
            {q:"Zwierzƒô domowe (nie pies/kot)", a:[["CHOMIK",42],["KR√ìLIK",28],["≈öWINKA MORSKA",18],["PAPUGA",8]]},
            {q:"Co≈õ, co tyka", a:[["ZEGAR",65],["BOMBA",25],["SERCE",8]]},
            {q:"Gdzie trzymamy pieniƒÖdze?", a:[["W BANKU",48],["W PORTFELU",35],["W SKARPECIE",12]]},
            {q:"Zaw√≥d w mundurze", a:[["POLICJANT",45],["STRA≈ªAK",30],["≈ªO≈ÅNIERZ",20],["PILOT",4]]},
            {q:"Co ro≈õnie w ogrodzie?", a:[["KWIATY",42],["WARZYWA",28],["TRAWA",18],["DRZEWA",8]]},
            {q:"≈örodek transportu miejskiego", a:[["AUTOBUS",55],["TRAMWAJ",30],["METRO",12]]},
            {q:"Co≈õ co lata", a:[["SAMOLOT",48],["PTAK",32],["MUCHA",15]]},
            {q:"Co ma klucze?", a:[["ZAMEK",44],["FORTEPIAN",26],["WO≈πNY",18]]},
            {q:"W co gramy?", a:[["W KARTY",40],["W PI≈ÅKƒò",30],["W SZACHY",18],["W GRY",10]]},
            {q:"Atrybut lekarza", a:[["STETOSKOP",52],["FARTUCH",24],["STRZYKAWKA",18]]}
        ];
        const FS = [
            ["1.Ro≈õlina k≈ÇujƒÖca", "2.Marka auta", "3.Czƒô≈õƒá roweru", "4.Miasto w PL", "5.Imiƒô na A"],
            ["1.Co≈õ s≈Çodkiego", "2.Instrument", "3.Drzewo", "4.Pa≈Ñstwo Europa", "5.Kolor"],
            ["1.Sport zimowy", "2.Ptak drapie≈ºny", "3.Mebel w salonie", "4.P≈Çyn do picia", "5.Zaw√≥d medyczny"],
            ["1.Co≈õ co parzy", "2.Czƒô≈õƒá twarzy", "3.Ryba s≈Çodkowodna", "4.Imiƒô ≈ºe≈Ñskie na M", "5.Planeta"],
            ["1.Co≈õ okrƒÖg≈Çego", "2.Stolica pa≈Ñstwa", "3.Narzƒôdzie warsztatowe", "4.Warzywo zielone", "5.Ptak domowy"],
            ["1.Co≈õ do pisania", "2.Marka opon", "3.Gra zespo≈Çowa", "4.Miasto nad morzem", "5.Przyprawa"],
            ["1.Co≈õ co ≈õwieci", "2.Kr√≥l Polski", "3.Pasmo g√≥rskie", "4.Owoc cytrusowy", "5.Nap√≥j alkoholowy"],
            ["1.Co ma ko≈Ça", "2.Bohater bajki", "3.Waluta", "4.Sport walki", "5.Instrument dƒôty"],
            ["1.Co≈õ co tyka", "2.Gatunek muzyki", "3.Drzewo iglaste", "4.Rzeka w Polsce", "5.Owad"],
            ["1.Co≈õ zimnego", "2.Jƒôzyk obcy", "3.Element komputera", "4.Kwiat wiosenny", "5.Czƒô≈õƒá nogi"]
        ];

        let peer=new Peer(), conn, sum=0, team=null, side='L', t1=0, t2=0;

        function connect() { conn=peer.connect(document.getElementById('tv-id').value); }
        
        function selectTeam(n, s) { 
            team=n; side=s; 
            document.querySelectorAll('.control').forEach(b=>b.disabled=false);
            document.getElementById('team1-btn').className = (n===1?'btn-active-team':'');
            document.getElementById('team2-btn').className = (n===2?'btn-active-team':'');
        }

        function addPts(n) { 
            if(n===1) t1+=sum; else t2+=sum; 
            sum=0; updS(); updT(); 
            send({type:'SCORE',val:0}); 
            resetSel(); 
        }

        function resetSel() { 
            team=null; 
            document.querySelectorAll('.control').forEach(b=>b.disabled=true); 
            document.getElementById('team1-btn').className=''; 
            document.getElementById('team2-btn').className=''; 
        }

        function updT() { 
            document.getElementById('t1-pts').innerText="D1: "+t1+" pkt"; 
            document.getElementById('t2-pts').innerText="D2: "+t2+" pkt"; 
        }

        function startR(n) { 
            sum=0; updS(); resetSel(); 
            send({type:'RESET_BOARD'}); 
            send({type:'PLAY_MEDIA',audio:'runda'}); 
        }

        window.onload=()=>{
            const s=document.getElementById('q-sel'); DB.forEach((x,i)=>s.innerHTML+=`<option value="${i}">${i+1}. ${x.q}</option>`);
            const fs=document.getElementById('f-sel'); for(let i=0;i<10;i++) fs.innerHTML+=`<option value="${i}">ZESTAW ${i+1}</option>`;
            const fi=document.getElementById('f-ins'); ['p1','p2'].forEach(p=>{
                fi.innerHTML+=`<div style="color:#e2ff00;margin-top:10px">${p.toUpperCase()}</div>`;
                for(let i=0;i<5;i++) fi.innerHTML+=`<div style="display:flex;gap:2px"><input id="f-${p}-t-${i}" style="width:100px"><input id="f-${p}-p-${i}" type="number" style="width:40px"><button onclick="revF('${p}',${i})" style="width:30px;background:#e2ff00;color:black">OK</button></div>`;
            });
            preQ(); showFH();
        };

        function sendQ() { sum=0; updS(); const q=DB[document.getElementById('q-sel').value]; send({type:'SETUP_NORMAL',ans:q.a}); preQ(); }
        
        function preQ() { 
            const q=DB[document.getElementById('q-sel').value]; 
            document.getElementById('ans-pre').innerHTML=q.a.map((x,i)=>`<button class="control" onclick="revN(${i},'${x[0]}',${x[1]})" disabled style="text-align:left">${x[0]} (${x[1]})</button>`).join(''); 
        }

        function revN(i,t,p) { sum+=p; updS(); send({type:'REV_NORMAL',idx:i,t:t,p:p}); send({type:'SCORE',val:sum}); }
        function revF(p,i) { const t=document.getElementById(`f-${p}-t-${i}`).value.toUpperCase(), pts=parseInt(document.getElementById(`f-${p}-p-${i}`).value)||0; sum+=pts; updS(); send({type:'REV_FINAL',player:p,idx:i,t:t,p:pts}); send({type:'SCORE',val:sum}); }
        function showFH() { document.getElementById('f-h').innerHTML=FS[document.getElementById('f-sel').value].join("<br>"); }
        function updS() { document.getElementById('cur-sum').innerText=sum; }
        function sendX(n) { send({type:'X',side:side,n:n}); }
        function runT(s) { let c=s; send({type:'TIMER',action:'start',val:c}); let i=setInterval(()=>{c--;send({type:'TIMER',action:'tick',val:c});if(c<=0){clearInterval(i);send({type:'TIMER',action:'stop'});}},1000); }
        function send(d) { if(conn) conn.send(d); }
    </script>
</body>
</html>
