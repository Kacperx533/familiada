<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - FULL OPTION</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; padding: 20px; display: grid; grid-template-columns: 400px 1fr; gap: 20px; }
        .card { background: #1e1e1e; padding: 15px; border-radius: 10px; border-top: 4px solid gold; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        h3 { color: gold; margin-top: 0; font-size: 14px; text-transform: uppercase; }
        button { width: 100%; padding: 10px; margin: 3px 0; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; transition: 0.2s; }
        button:hover { filter: brightness(1.2); }
        .btn-blue { background: #0066ff; color: white; }
        .btn-red { background: #cc0000; color: white; }
        .btn-green { background: #28a745; color: white; }
        .btn-gold { background: gold; color: black; }
        .btn-grey { background: #444; color: white; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        input, select { width: 100%; padding: 10px; background: #000; color: white; border: 1px solid #333; border-radius: 5px; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; }
        #panel-final { display: none; }
    </style>
</head>
<body>

    <div>
        <div class="card">
            <h3>1. PO≈ÅƒÑCZENIE</h3>
            <input type="text" id="tv-id" placeholder="Wklej ID z ekranu TV">
            <button class="btn-green" onclick="connect()" style="margin-top:10px">PO≈ÅƒÑCZ SYSTEMY</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button class="btn-blue" onclick="send({type:'VIDEO'})">üé¨ ODTW√ìRZ CZO≈Å√ìWKƒò (WIDEO)</button>
            <button class="btn-gold" onclick="send({type:'THEME'})">üéµ MUZYKA INTRA (AUDIO)</button>
            <div class="grid-2">
                <button class="btn-grey" onclick="send({type:'SOUND', f:'round'})">üéµ MUZYKA RUNDY</button>
                <button class="btn-grey" onclick="send({type:'SOUND', f:'rep'})">‚ö†Ô∏è POWT√ìRZENIE</button>
            </div>
            <div class="grid-2">
                <button class="btn-grey" onclick="send({type:'SOUND', f:'ok'})">‚úîÔ∏è D≈πWIƒòK OK</button>
                <button class="btn-grey" onclick="send({type:'SOUND', f:'bad'})">‚ùå D≈πWIƒòK B≈ÅƒÑD</button>
            </div>
        </div>

        <div class="card">
            <h3>3. B≈ÅƒòDY (X)</h3>
            <div class="grid-2">
                <div style="text-align:center; color:#0066ff">NIEBIESCY</div>
                <div style="text-align:center; color:#cc0000">CZERWONI</div>
                <button class="btn-blue" onclick="send({type:'STRIKE', n:1, team:'blue'})">X</button>
                <button class="btn-red" onclick="send({type:'STRIKE', n:1, team:'red'})">X</button>
                <button class="btn-blue" onclick="send({type:'STRIKE', n:2, team:'blue'})">XX</button>
                <button class="btn-red" onclick="send({type:'STRIKE', n:2, team:'red'})">XX</button>
                <button class="btn-blue" onclick="send({type:'STRIKE', n:3, team:'blue'})">XXX</button>
                <button class="btn-red" onclick="send({type:'STRIKE', n:3, team:'red'})">XXX</button>
            </div>
        </div>
    </div>

    <div>
        <div id="panel-rounds">
            <div class="card">
                <h3>4. WYB√ìR ZESTAWU (RUNDY 1-10)</h3>
                <select id="q-sel" onchange="loadQ()"></select>
                <button class="btn-gold" onclick="sendQ()" style="margin-top:10px; height:50px">WY≈öLIJ PYTANIE NA TABLICƒò</button>
                <button class="btn-red" onclick="showFinal()" style="margin-top:10px">URUCHOM TRYB FINA≈ÅU</button>
            </div>
            <div class="card">
                <h3>ODPOWIEDZI NA TABLICY</h3>
                <div id="ans-box" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;"></div>
            </div>
        </div>

        <div id="panel-final">
            <div class="card">
                <h3>üèÜ TRYB FINA≈ÅOWY</h3>
                <div class="grid-2">
                    <button class="btn-red" onclick="send({type:'TIMER', val:15})">START 15 SEKUND (G1)</button>
                    <button class="btn-red" onclick="send({type:'TIMER', val:20})">START 20 SEKUND (G2)</button>
                </div>
                <button class="btn-grey" onclick="showRounds()" style="margin-top:10px">POWR√ìT DO RUND</button>
            </div>
            <div class="card">
                <h3>TABELA FINA≈ÅOWA</h3>
                <table>
                    <thead>
                        <tr><th>NR</th><th>GRACZ 1 (Has≈Ço | Pkt)</th><th>GRACZ 2 (Has≈Ço | Pkt)</th></tr>
                    </thead>
                    <tbody id="final-table-body">
                        </tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <h3>5. PUNKTACJA OG√ìLNA</h3>
            <div class="grid-2" style="text-align: center; font-size: 24px;">
                <div>NIEBIESCY: <span id="ds1" style="color:white">0</span></div>
                <div>CZERWONI: <span id="ds2" style="color:white">0</span></div>
            </div>
            <div style="text-align: center; font-size: 40px; color: gold; margin: 10px 0;">SUMA RUNDY: <span id="dsum">0</span></div>
            <div class="grid-2">
                <button class="btn-blue" onclick="addScore('blue')">PRZEKA≈ª NIEBIESKIM</button>
                <button class="btn-red" onclick="addScore('red')">PRZEKA≈ª CZERWONYM</button>
            </div>
            <button class="btn-grey" onclick="resetAll()">ZERUJ WSZYSTKO</button>
        </div>
    </div>

    <script>
        const DB = [
            {q:"Zestaw 1: Co robimy rano?", a:[["MYJEMY ZƒòBY",40],["JEMY ≈öNIADANIE",30],["PIJEMY KAWƒò",20],["UBIERAMY SIƒò",10]]},
            {q:"Zestaw 2: Zwierzƒô na wie≈õ?", a:[["KROWA",45],["KURA",25],["KO≈É",15],["≈öWINIA",10],["KACZKA",5]]},
            {q:"Zestaw 3: Co pijemy na gorƒÖco?", a:[["HERBATƒò",50],["KAWƒò",30],["KAKAO",20]]},
            {q:"Zestaw 4: Przedmiot szkolny?", a:[["MATEMATYKA",40],["WF",30],["POLSKI",20],["PLASTYKA",10]]},
            {q:"Zestaw 5: Co jest w pi√≥rniku?", a:[["D≈ÅUGOPIS",40],["O≈Å√ìWEK",30],["GUMKA",20],["LINIJKA",10]]},
            {q:"Zestaw 6: Owoc na literƒô J?", a:[["JAB≈ÅKO",60],["JE≈ªYNA",20],["JAGODA",20]]},
            {q:"Zestaw 7: Co na pla≈ºƒô?", a:[["RƒòCZNIK",40],["KREM",30],["PARAWAN",20],["PI≈ÅKA",10]]},
            {q:"Zestaw 8: Dyscyplina sportowa?", a:[["PI≈ÅKA NO≈ªNA",50],["SIATK√ìWKA",30],["BIEGANIE",20]]},
            {q:"Zestaw 9: Co ro≈õnie w lesie?", a:[["DRZEWA",50],["GRZYBY",30],["MECH",20]]},
            {q:"Zestaw 10: Marka samochodu?", a:[["FIAT",30],["BMW",25],["AUDI",20],["TOYOTA",15]]}
        ];

        let conn, peer = new Peer(), s1=0, s2=0, rSum=0;

        window.onload = () => {
            const s = document.getElementById('q-sel');
            DB.forEach((x, i) => s.innerHTML += `<option value="${i}">${x.q}</option>`);
            
            const tbody = document.getElementById('final-table-body');
            for(let i=0; i<5; i++) {
                tbody.innerHTML += `
                    <tr>
                        <td>${i+1}</td>
                        <td>
                            <input type="text" id="f1t-${i}" style="width:100px"> <input type="number" id="f1p-${i}">
                            <button class="btn-blue" style="width:auto; padding:5px 10px" onclick="revF(1, ${i})">OK</button>
                        </td>
                        <td>
                            <input type="text" id="f2t-${i}" style="width:100px"> <input type="number" id="f2p-${i}">
                            <button class="btn-red" style="width:auto; padding:5px 10px" onclick="revF(2, ${i})">OK</button>
                        </td>
                    </tr>`;
            }
            loadQ();
        };

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => alert("PO≈ÅƒÑCZONO Z TABLICƒÑ!"));
        }

        function loadQ() {
            const q = DB[document.getElementById('q-sel').value];
            const box = document.getElementById('ans-box'); box.innerHTML = '';
            q.a.forEach((x, i) => {
                const b = document.createElement('button');
                b.className = 'btn-grey';
                b.innerText = `${x[0]} (${x[1]})`;
                b.onclick = () => { rSum += x[1]; update(); send({type:'REV', idx:i}); b.style.background = '#28a745'; };
                box.appendChild(b);
            });
        }

        function sendQ() {
            rSum = 0; update();
            const q = DB[document.getElementById('q-sel').value];
            send({type:'SETUP', ans: q.a.map(x=>({t:x[0], p:x[1]}))});
        }

        function showFinal() { document.getElementById('panel-rounds').style.display='none'; document.getElementById('panel-final').style.display='block'; send({type:'FINAL_UI'}); }
        function showRounds() { document.getElementById('panel-rounds').style.display='block'; document.getElementById('panel-final').style.display='none'; }
        
        function revF(p, i) {
            const txt = document.getElementById(`f${p}t-${i}`).value.toUpperCase();
            const pts = document.getElementById(`f${p}p-${i}`).value;
            send({type:'FINAL_REV', p:p, i:i, txt:txt, pts:pts});
        }

        function addScore(team) { if(team==='blue') s1+=rSum; else s2+=rSum; rSum=0; update(); }
        function update() {
            document.getElementById('ds1').innerText=s1;
            document.getElementById('ds2').innerText=s2;
            document.getElementById('dsum').innerText=rSum;
            send({type:'SCORE', s1:s1, s2:s2, sum:rSum});
        }
        function resetAll() { s1=0; s2=0; rSum=0; update(); }
        function send(d) { if(conn) conn.send(d); }
    </script>
</body>
</html>
