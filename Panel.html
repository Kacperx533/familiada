<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - FAMILIADA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; display: grid; grid-template-columns: 400px 1fr; gap: 20px; }
        .card { background: #2a2a2a; padding: 15px; border-radius: 10px; border-top: 4px solid gold; margin-bottom: 15px; }
        button { width: 100%; padding: 10px; margin: 3px 0; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        .btn-blue { background: #0066ff; color: white; }
        .btn-red { background: #cc0000; color: white; }
        .btn-green { background: #28a745; color: white; }
        .btn-gold { background: gold; color: black; }
        .btn-grey { background: #555; color: white; }
        input { width: 100%; padding: 10px; box-sizing: border-box; background: #000; color: white; border: 1px solid #444; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
    </style>
</head>
<body>
    <div>
        <div class="card">
            <h3>1. PO≈ÅƒÑCZENIE</h3>
            <input type="text" id="tv-id" placeholder="Wpisz ID z TV">
            <button class="btn-green" onclick="connect()">PO≈ÅƒÑCZ</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button class="btn-blue" onclick="send({type:'VIDEO'})">üé¨ ODTW√ìRZ CZO≈Å√ìWKƒò (WIDEO)</button>
            <button class="btn-gold" onclick="send({type:'THEME'})">üéµ MUZYKA INTRA (SAM DZWIƒòK)</button>
            <button class="btn-red" onclick="send({type:'REPEAT'})">‚ö†Ô∏è D≈πWIƒòK POWT√ìRZENIA</button>
        </div>

        <div class="card">
            <h3>3. B≈ÅƒòDY (X)</h3>
            <div class="grid-2">
                <button class="btn-blue" onclick="send({type:'STRIKE', n:1, team:'blue'})">NIEBIESKI X</button>
                <button class="btn-red" onclick="send({type:'STRIKE', n:1, team:'red'})">CZERWONY X</button>
            </div>
        </div>

        <div class="card">
            <h3>4. FINA≈Å - TIMER</h3>
            <button class="btn-blue" onclick="send({type:'FINAL_START'})">AKTYWUJ TRYB FINA≈ÅU</button>
            <div class="grid-2">
                <button class="btn-red" onclick="send({type:'TIMER', val:15})">START 15s (G1)</button>
                <button class="btn-red" onclick="send({type:'TIMER', val:20})">START 20s (G2)</button>
            </div>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>5. PYTANIA (10 ZESTAW√ìW)</h3>
            <select id="q-sel" onchange="loadQ()" style="width:100%; padding:10px;"></select>
            <button class="btn-green" onclick="sendQ()">WY≈öLIJ NA TABLICƒò</button>
            <div id="ans-box" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;"></div>
        </div>

        <div class="card">
            <h3>6. FINA≈Å - WPROWADZANIE</h3>
            <div class="grid-2">
                <input type="text" id="ft" placeholder="Has≈Ço">
                <input type="number" id="fp" placeholder="Pkt">
            </div>
            <div class="grid-2">
                <button class="btn-blue" onclick="sendF(1)">ODS≈ÅO≈É G1</button>
                <button class="btn-red" onclick="sendF(2)">ODS≈ÅO≈É G2</button>
            </div>
            <select id="fi" style="width:100%; margin-top:5px;">
                <option value="0">Pytanie 1</option><option value="1">Pytanie 2</option>
                <option value="2">Pytanie 3</option><option value="3">Pytanie 4</option>
                <option value="4">Pytanie 5</option>
            </select>
        </div>

        <div class="card">
            <h3>PUNKTY DRU≈ªYN</h3>
            <div class="grid-2">
                <button class="btn-blue" onclick="addScore('blue')">PUNKTY -> NIEBIESCY</button>
                <button class="btn-red" onclick="addScore('red')">PUNKTY -> CZERWONI</button>
            </div>
            <button class="btn-grey" onclick="resetAll()">ZERUJ WSZYSTKO</button>
        </div>
    </div>

    <script>
        const DB = [
            {q:"Zestaw 1", a:[["KOT",30],["PIES",20],["CHOMIK",10]]},
            {q:"Zestaw 2", a:[["WODA",40],["SOK",20],["KAWA",10]]},
            {q:"Zestaw 3", a:[["DOM",35],["BLOK",15],["WILLA",5]]},
            {q:"Zestaw 4", a:[["LAS",25],["POLE",20],["≈ÅƒÑKA",10]]},
            {q:"Zestaw 5", a:[["AUTO",30],["ROWER",20],["BUS",10]]},
            {q:"Zestaw 6", a:[["LATO",50],["ZIMA",30],["JESIE≈É",10]]},
            {q:"Zestaw 7", a:[["JAB≈ÅKO",40],["BANAN",20],["GRUSZKA",10]]},
            {q:"Zestaw 8", a:[["G√ìRY",30],["MORZE",30],["JEZIORO",10]]},
            {q:"Zestaw 9", a:[["CHLEB",45],["BU≈ÅKA",25],["ROGAL",10]]},
            {q:"Zestaw 10", a:[["WF",30],["MATEMATYKA",20],["POLSKI",10]]}
        ];

        let conn, peer = new Peer(), s1=0, s2=0, rSum=0;

        window.onload = () => {
            const s = document.getElementById('q-sel');
            DB.forEach((x, i) => s.innerHTML += `<option value="${i}">${x.q}</option>`);
            loadQ();
        };

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => alert("PO≈ÅƒÑCZONO!"));
        }

        function loadQ() {
            const q = DB[document.getElementById('q-sel').value];
            const box = document.getElementById('ans-box'); box.innerHTML = '';
            q.a.forEach((x, i) => {
                const b = document.createElement('button'); b.className = 'btn-grey';
                b.innerText = `${x[0]} (${x[1]})`;
                b.onclick = () => { rSum += x[1]; update(); send({type:'REV', idx:i}); b.style.background = 'green'; };
                box.appendChild(b);
            });
        }

        function sendQ() {
            rSum = 0; update();
            const q = DB[document.getElementById('q-sel').value];
            send({type:'SETUP', ans: q.a.map(x=>({t:x[0], p:x[1]}))});
        }

        function sendF(p) {
            send({type:'FINAL_REV', p:p, i:document.getElementById('fi').value, txt:document.getElementById('ft').value.toUpperCase(), pts:document.getElementById('fp').value});
        }

        function addScore(team) { if(team === 'blue') s1 += rSum; else s2 += rSum; rSum = 0; update(); }
        function send(d) { if(conn) conn.send(d); }
        function update() { send({type:'SCORE', s1:s1, s2:s2, sum:rSum}); }
        function resetAll() { s1=0; s2=0; rSum=0; update(); }
    </script>
</body>
</html>
