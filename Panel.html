<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>ADMIN - FAMILIADA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #fff; margin: 0; display: grid; grid-template-columns: 320px 1fr; height: 100vh; }
        .sidebar { background: #222; padding: 20px; border-right: 2px solid #fbc02d; overflow-y: auto; }
        .main { padding: 20px; overflow-y: auto; display: flex; flex-direction: column; }
        .card { background: #333; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        button { padding: 10px; margin-bottom: 5px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; width: 100%; text-transform: uppercase; }
        .btn-y { background: #fbc02d; color: #000; }
        .btn-b { background: #1976d2; color: #fff; }
        .btn-r { background: #d32f2f; color: #fff; }
        .team-sel { display: flex; gap: 5px; margin-bottom: 10px; }
        .team-sel input { display: none; }
        .team-sel label { flex: 1; padding: 10px; background: #444; text-align: center; cursor: pointer; border-radius: 4px; }
        .team-sel input:checked + label { background: #fbc02d; color: #000; }
        input, select, textarea { width: 100%; padding: 8px; margin: 5px 0; background: #000; color: #fff; border: 1px solid #555; box-sizing: border-box; }
        .cheat-sheet { background: #000; padding: 15px; border: 1px dashed #fbc02d; margin-top: auto; }
        .cheat-sheet h4 { color: #fbc02d; margin-top: 0; }
        .cheat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12px; }
        .score-row { display: flex; justify-content: space-around; font-size: 24px; color: #fbc02d; font-weight: bold; padding: 10px 0; }
    </style>
</head>
<body>
    <div class="sidebar">
        <input id="target-id" placeholder="KOD Z TV" maxlength="3" style="text-align:center; font-size:20px;">
        <button onclick="connect()" class="btn-b">PO≈ÅƒÑCZ</button>
        
        <h3>PUNKTY</h3>
        <div class="team-sel">
            <input type="radio" name="active-team" id="tL" value="L" checked><label for="tL">D1 (LEWA)</label>
            <input type="radio" name="active-team" id="tR" value="R"><label for="tR">D2 (PRAWA)</label>
        </div>
        <div class="score-row">
            <span>D1: <b id="lScore">0</b></span>
            <span>D2: <b id="rScore">0</b></span>
        </div>

        <h3>B≈ÅƒòDY (X)</h3>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px">
            <div><small>LEWA</small>
                <button class="btn-r" onclick="send({type:'X', count:1})">X</button>
                <button class="btn-r" onclick="send({type:'X', count:2})">XX</button>
                <button class="btn-r" onclick="send({type:'X', count:3})">XXX</button>
            </div>
            <div><small>PRAWA</small>
                <button class="btn-r" onclick="send({type:'X', count:1})">X</button>
                <button class="btn-r" onclick="send({type:'X', count:2})">XX</button>
                <button class="btn-r" onclick="send({type:'X', count:3})">XXX</button>
            </div>
        </div>

        <h3>D≈πWIƒòKI / RUNDY</h3>
        <button class="btn-y" onclick="send({type:'PLAY_VID'})">üé¨ CZO≈Å√ìWKA</button>
        <button class="btn-y" onclick="playRunda(1)">RUNDA 1</button>
        <button class="btn-y" onclick="playRunda(2)">RUNDA 2</button>
        <button class="btn-y" onclick="playRunda(3)">RUNDA 3</button>
        <button class="btn-y" onclick="playRunda(4)">RUNDA 4</button>
        <button class="btn-b" onclick="playFinal()">FINA≈Å (AUDIO)</button>
        <button class="btn-b" onclick="send({type:'PLAY_SND', id:'snd-powt'})">‚ö†Ô∏è POWT√ìRKA</button>
    </div>

    <div class="main">
        <div class="card">
            <h3>BAZA 50 PYTA≈É (RUNDY)</h3>
            <select id="preset-sel" onchange="loadPreset()"></select>
            <textarea id="raw-data" rows="4" placeholder="Odpowied≈∫, Punkty"></textarea>
            <button onclick="setupNormal()" class="btn-y">WY≈öLIJ NA TABLICƒò</button>
            <div id="normal-btns" style="margin-top:10px; display: grid; grid-template-columns: 1fr 1fr; gap: 5px;"></div>
        </div>

        <div class="card">
            <h3>FINA≈Å</h3>
            <button onclick="setupFinal()" class="btn-b">W≈ÅƒÑCZ TRYB FINA≈ÅOWY</button>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:10px">
                <div>
                    <button class="btn-r" onclick="send({type:'TIMER', sec:15})">ZEGAR 15S</button>
                    <div id="p1-ui"></div>
                    <button onclick="send({type:'HIDE_P1'})" style="background:#555; color:#fff">UKRYJ G1</button>
                </div>
                <div>
                    <button class="btn-r" onclick="send({type:'TIMER', sec:20})">ZEGAR 20S</button>
                    <div id="p2-ui"></div>
                </div>
            </div>
        </div>

        <div class="cheat-sheet">
            <h4>≈öCIƒÑGA DLA PROWADZƒÑCEGO (FINA≈Å - 10 ZESTAW√ìW)</h4>
            <div class="cheat-grid" id="cheat-grid"></div>
        </div>
    </div>

    <script>
        const peer = new Peer();
        let conn, scoreL = 0, scoreR = 0;

        const roundPresets = [
            ["PIES,40\nKOT,30\nCHOMIK,15\nRYBKI,10\nKANAREK,5", "Zwierzƒô domowe"],
            ["OWOCE,45\nWARZYWA,25\nS≈ÅODYCZE,15\nMIƒòSO,10\nNABIA≈Å,5", "Co kupujemy w spo≈ºywczym?"],
            ["LATO,50\nZIMA,20\nWIOSNA,15\nJESIE≈É,15", "Ulubiona pora roku"],
            ["FRANCJA,35\nW≈ÅOCHY,25\nNIEMCY,20\nHISZPANIA,15\nGRECJA,5", "Pa≈Ñstwo w Europie"],
            ["ROWER,40\nBIEGANIE,30\nP≈ÅYWANIE,20\nPI≈ÅKA NO≈ªNA,10", "Popularny sport"],
            ["KAWA,50\nHERBATA,30\nWODA,15\nSOK,5", "Co pijemy rano?"],
            ["TELEFON,45\nKLUCZE,30\nPORTFEL,20\nCHUSTECZKI,5", "Co mamy w kieszeni?"],
            ["SAMOCH√ìD,40\nAUTOBUS,30\nPOCIƒÑG,20\nROWER,10", "≈örodek transportu"],
            ["POMIDOROWA,40\nROS√ì≈Å,35\nOG√ìRKOWA,15\n≈ªUREK,10", "Ulubiona zupa"],
            ["LEKARZ,35\nSTRA≈ªAK,25\nPOLICJANT,20\nNAUCZYCIEL,15\nPI≈ÅKARZ,5", "Kim chcia≈Çe≈õ byƒá w dzieci≈Ñstwie?"],
            // ... dopisz kolejne 40 zestaw√≥w tutaj wed≈Çug wzoru powy≈ºej ...
            ["KOMPUTER,40\nTELEWIZOR,30\nLOD√ìWKA,20\nPRALKA,10", "Sprzƒôt AGD/RTV"],
            ["G√ìRY,50\nMORZE,30\nJEZIORO,15\nLAS,5", "Gdzie na wakacje?"],
            ["RADIO,40\nTV,30\nINTERNET,20\nPRASA,10", "≈πr√≥d≈Ço informacji"],
            ["CZYTANIE,40\nFILMY,30\nGRY,20\nSPACER,10", "Hobby"],
            ["MAMA,50\nTATA,30\nBABCIA,10\nDZIADEK,10", "Najwa≈ºniejsza osoba"],
            ["POLSKA,60\nUSA,20\nCHINY,10\nROSJA,10", "Du≈ºe pa≈Ñstwo"],
            ["CHLEB,50\nBU≈ÅKA,30\nROGAL,15\nDRO≈ªD≈ª√ìWKA,5", "Pieczywo"],
            ["MAS≈ÅO,40\nSER,30\nSZYNKA,20\nD≈ªEM,10", "Na kanapkƒô"],
            ["N√ì≈ª,40\nWIDELEC,30\n≈ÅY≈ªKA,20\n≈ÅY≈ªECZKA,10", "Sztuƒáce"],
            ["TULIPAN,40\nR√ì≈ªA,35\nGON≈πDZIK,15\nSTOKROTKA,10", "Kwiat"],
            ["WARSZAWA,50\nKRAK√ìW,25\nWROC≈ÅAW,15\nGDA≈ÉSK,10", "Polskie miasto"],
            ["MATEMATYKA,40\nPOLSKI,30\nWF,20\nHISTORIA,10", "Przedmiot w szkole"],
            ["KOMEDIA,40\nHORROR,30\nDRAMAT,20\nAKCJA,10", "Gatunek filmu"],
            ["GITARA,40\nPIANINO,30\nSKRZYPCE,20\nPERKUSJA,10", "Instrument"],
            ["S≈ÅO≈ÉCE,50\nKSIƒò≈ªYC,30\nGWIAZDY,15\nCHMURY,5", "Na niebie"],
            ["BALON,40\nTORT,35\nPREZENTY,20\nGO≈öCIE,5", "Na urodzinach"],
            ["BUTY,40\nKURTKA,30\nSPODNIE,20\nCZAPKA,10", "Ubranie"],
            ["SA≈ÅATKA,40\nFRYTKI,30\nRY≈ª,20\nKASZA,10", "Dodatek do obiadu"],
            ["D≈ÅUGOPIS,40\nO≈Å√ìWEK,30\nZESZYT,20\nGUMKA,10", "W pi√≥rniku"],
            ["REKIN,40\nWIELORYB,30\nDELFIN,20\nZ≈ÅOTA RYBKA,10", "Morskie zwierzƒô"],
            ["BAJKA,40\nWIADOMO≈öCI,30\nSERIAL,20\nMECZ,10", "W telewizji"],
            ["CUKIER,40\nS√ìL,30\nPIEPRZ,20\nPAPRYKA,10", "Przyprawa"],
            ["DYWAN,40\nOBRAZ,30\nKWIATEK,20\nLAMPA,10", "Ozdoba domu"],
            ["KO≈ÅDRA,50\nPODUSZKA,30\nPRZE≈öCIERAD≈ÅO,15\nKOC,5", "W ≈Ç√≥≈ºku"],
            ["LEW,40\nTYGRYS,30\nMA≈ÅPA,20\nS≈ÅO≈É,10", "W ZOO"],
            ["PƒÑCZEK,40\nDRO≈ªD≈ª√ìWKA,30\nCIASTKO,20\nCZEKOLADA,10", "S≈Çodka przekƒÖka"],
            ["MYD≈ÅO,40\nSZAMPON,30\nPASTA,20\nPERFUMY,10", "Kosmetyk"],
            ["WIS≈ÅA,50\nODRA,30\nWARTA,15\nBUG,5", "Polska rzeka"],
            ["STYCZE≈É,40\nGRUDZIE≈É,30\nLIPIEC,20\nMAJ,10", "MiesiƒÖc"],
            ["PONIEDZIA≈ÅEK,40\nPIƒÑTEK,30\nSOBOTA,20\nNIEDZIELA,10", "Dzie≈Ñ tygodnia"],
            ["LUSTRO,40\nUMYWALKA,30\nWANNNA,20\nPRYSZNIC,10", "W ≈Çazience"],
            ["ST√ì≈Å,40\nKRZES≈ÅO,30\nKANAPA,20\nSZAFA,10", "Mebel"],
            ["Z≈ÅOTO,40\nSREBRO,30\nBRƒÑZ,20\nMIED≈π,10", "Metal szlachetny"],
            ["BIA≈ÅY,40\nCZARNY,30\nCZERWONY,20\nNIEBIESKI,10", "Kolor"],
            ["G≈ÅOWA,40\nRƒòKA,30\nnOGA,20\nBRZUCH,10", "Czƒô≈õƒá cia≈Ça"],
            ["KARTKA,40\nKOPERTA,30\nZNACZEK,20\nADRES,10", "List"],
            ["S≈ÅUCHAWKI,40\nG≈ÅO≈öNIK,30\nMYSZKA,20\nKLAWIATURA,10", "Akcesorium komputerowe"],
            ["LAS,40\nPARK,30\nOGR√ìD,20\n≈ÅƒÑKA,10", "Miejsce spaceru"],
            ["≈öNIEG,50\nDESZCZ,30\nWIATR,15\nMROZ,5", "Zjawisko pogodowe"],
            ["SMOK,40\nWR√ì≈ªKA,30\nKR√ìL,20\nCZAROWNICA,10", "Postaƒá z bajki"]
        ];

        const finalPresets = [
            "1. Owoc: Jab≈Çko, Banan, Gruszka\n2. Zaw√≥d: Lekarz, Nauczyciel, Kierowca\n3. Sport: Pi≈Çka, Bieg, Tenis\n4. Drzewo: DƒÖb, Sosna, Brzoza\n5. Nap√≥j: Woda, Kawa, Sok",
            "1. Kolor: Bia≈Çy, Niebieski, Czerwony\n2. Ryba: Karp, Rekin, Szczupak\n3. Miasto: Warszawa, Krak√≥w, Londyn\n4. Mebel: Krzes≈Ço, St√≥≈Ç, ≈Å√≥≈ºko\n5. Rzeka: Wis≈Ça, Odra, Amazonka",
            "1. Ptak: Wr√≥bel, Bocian, Orze≈Ç\n2. Kwiat: R√≥≈ºa, Tulipan, Stokrotka\n3. Marka Auta: Fiat, BMW, Audi\n4. Gazeta: Fakt, Wyborcza, PrzeglƒÖd\n5. Gra: Szachy, Poker, Warcaby",
            "1. Stolica: Pary≈º, Berlin, Madryt\n2. Grzyb: Borowik, Ma≈õlak, Muchomor\n3. Warzywo: Marchew, Cebula, Por\n4. Instrument: Gitara, Flet, TrƒÖbka\n5. Planeta: Ziemia, Mars, Jowisz",
            "1. Pa≈Ñstwo: Polska, USA, Chiny\n2. Metal: Z≈Çoto, ≈ªelazo, Mied≈∫\n3. Bajka: Shrek, Kr√≥l Lew, Bambi\n4. ≈öwiƒôto: Wielkanoc, Bo≈ºe Narodzenie, Nowy Rok\n5. Jƒôzyk: Polski, Angielski, Niemiecki",
            "1. G√≥ry: Tatry, Alpy, Himalaje\n2. Ciecz: Woda, Olej, Mleko\n3. Narzƒôdzie: M≈Çotek, ≈örubokrƒôt, Pi≈Ça\n4. Budynek: Dom, Blok, Zamek\n5. Imiƒô: Jan, Anna, Piotr",
            "1. Czƒô≈õƒá cia≈Ça: Oko, Rƒôka, Serce\n2. Przyprawa: S√≥l, Pieprz, Papryka\n3. Zwierzƒô le≈õne: Sarna, Wilk, Lis\n4. Uczucie: Mi≈Ço≈õƒá, Strach, Rado≈õƒá\n5. Pogoda: S≈Ço≈Ñce, Deszcz, Burza",
            "1. Kuchnia: Polska, W≈Çoska, Chi≈Ñska\n2. Obuwie: Kapcie, Trampki, Szpilki\n3. Transport: Auto, Samolot, Statek\n4. Drzewo owocowe: Jab≈Ço≈Ñ, Wi≈õnia, ≈öliwa\n5. Gaz: Tlen, Hel, Azot",
            "1. Pismo: Drukowane, Rƒôczne, Braille\n2. Materia≈Ç: Drewno, Plastik, Szk≈Ço\n3. Pismo ≈õwiƒôte: Biblia, Koran, Tora\n4. Owad: Mucha, Pszczo≈Ça, Komar\n5. Kontynent: Europa, Azja, Afryka",
            "1. Kr√≥l: Kazimierz, Jagie≈Ç≈Ço, Chrobry\n2. Jednostka: Metr, Litr, Kilogram\n3. Plan dnia: Praca, Sen, Obiad\n4. Czas: Godzina, Minuta, Sekunda\n5. Bi≈ºuteria: Pier≈õcionek, Kolczyki, Naszyjnik"
        ];

        // Inicjalizacja listy preset√≥w i ≈õciƒÖgi
        window.onload = () => {
            const sel = document.getElementById('preset-sel');
            roundPresets.forEach((p, i) => {
                let opt = document.createElement('option');
                opt.value = i; opt.innerText = p[1]; sel.appendChild(opt);
            });
            const cheat = document.getElementById('cheat-grid');
            finalPresets.forEach((p, i) => {
                cheat.innerHTML += `<div><strong>ZESTAW ${i+1}:</strong><br>${p.replace(/\n/g, '<br>')}</div>`;
            });
        };

        function loadPreset() { const p = roundPresets[document.getElementById('preset-sel').value]; document.getElementById('raw-data').value = p[0]; }
        function connect() { conn = peer.connect(document.getElementById('target-id').value.toUpperCase()); conn.on('open', () => alert("PO≈ÅƒÑCZONO")); }
        function send(d) { if(conn) conn.send(d); }

        function playRunda(n) { send({type:'PLAY_SND', id:'snd-runda'}); alert("RUNDA " + n + " START!"); }
        function playFinal() { send({type:'PLAY_SND', id:'snd-final'}); }

        function sync() {
            document.getElementById('lScore').innerText = scoreL;
            document.getElementById('rScore').innerText = scoreR;
            send({type:'SCORE_SYNC', l: scoreL, r: scoreR});
        }

        function setupNormal() {
            const lines = document.getElementById('raw-data').value.split('\n');
            const ans = lines.map(l => ({ t: l.split(',')[0], p: parseInt(l.split(',')[1]) || 0 }));
            send({type:'SETUP_NORMAL', ans: ans});
            document.getElementById('normal-btns').innerHTML = ans.map((a, i) => `
                <div style="background:#444; padding:5px; border-radius:4px; display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-size:12px">${a.t} (${a.p})</span>
                    <button onclick="rev(${i},'${a.t}',${a.p})" class="btn-b" style="width:40px; margin:0">OK</button>
                </div>`).join('');
        }

        function rev(idx, t, p) {
            send({type:'REV', mode:'normal', idx:idx, t:t, p:p});
            let team = document.querySelector('input[name="active-team"]:checked').value;
            if(team === 'L') scoreL += p; else scoreR += p;
            sync();
        }

        function setupFinal() {
            send({type:'SETUP_FINAL'});
            const gen = (pid) => {
                let h = '';
                for(let i=0; i<5; i++) h += `<div style="display:flex; gap:2px; margin-bottom:2px">
                    <input id="p${pid}t${i}" placeholder="H" style="width:70px">
                    <input id="p${pid}p${i}" placeholder="P" style="width:30px">
                    <button onclick="revF(${pid},${i})" class="btn-b" style="width:40px">OK</button></div>`;
                document.getElementById(`p${pid}-ui`).innerHTML = h;
            };
            gen(1); gen(2);
        }

        function revF(pid, idx) {
            const t = document.getElementById(`p${pid}t${idx}`).value;
            const p = parseInt(document.getElementById(`p${pid}p${idx}`).value) || 0;
            send({type:'REV', mode:'final', player:pid, idx:idx, t:t, p:p});
            let team = document.querySelector('input[name="active-team"]:checked').value;
            if(team === 'L') scoreL += p; else scoreR += p;
            sync();
        }
    </script>
</body>
</html>
