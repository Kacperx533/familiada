<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>FAMILIADA PANEL - SYSTEM PRO</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; display: grid; grid-template-columns: 380px 1fr; gap: 20px; }
        .card { background: #2a2a2a; padding: 15px; border-radius: 10px; border-top: 4px solid gold; margin-bottom: 15px; }
        h3 { color: gold; margin: 0 0 10px 0; font-size: 14px; text-transform: uppercase; }
        button { width: 100%; padding: 12px; margin: 3px 0; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        .btn-blue { background: #0066ff; color: white; }
        .btn-red { background: #cc0000; color: white; }
        .btn-gold { background: gold; color: black; }
        .btn-grey { background: #444; color: white; }
        .active-team { outline: 4px solid white; box-shadow: 0 0 15px white; }
        input, select { width: 100%; padding: 10px; box-sizing: border-box; background: #000; color: white; border: 1px solid #333; margin-bottom: 5px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        #panel-final { display: none; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #444; padding: 5px; text-align: left; font-size: 12px; }
        .helper-text { font-size: 11px; color: #ffd700; background: #000; padding: 10px; border-radius: 5px; margin-top: 10px; line-height: 1.5; }
    </style>
</head>
<body>
    <div>
        <div class="card">
            <h3>1. PO≈ÅƒÑCZENIE</h3>
            <input type="text" id="tv-id" placeholder="WPISZ KOD Z TABLICY TV">
            <button class="btn-gold" onclick="connect()">PO≈ÅƒÑCZ SYSTEMY</button>
        </div>
        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button class="btn-blue" onclick="send({type:'VIDEO'})">üé¨ ODTW√ìRZ CZO≈Å√ìWKƒò</button>
            <button class="btn-grey" onclick="send({type:'SOUND', f:'intro'})">üéµ MUZYKA INTRA</button>
            <button class="btn-grey" onclick="send({type:'SOUND', f:'rep'})">‚ö†Ô∏è D≈πWIƒòK POWT√ìRKI</button>
        </div>
        <div class="card">
            <h3>3. AKTYWNA DRU≈ªYNA (PUNKTY AUTO)</h3>
            <div class="grid-2">
                <button id="p-blue" class="btn-blue" onclick="setTeam('blue')">NIEBIESCY</button>
                <button id="p-red" class="btn-red" onclick="setTeam('red')">CZERWONI</button>
            </div>
            <div style="margin-top:10px" class="grid-2">
                <button class="btn-grey" onclick="strike(1)">B≈ÅƒÑD X</button>
                <button class="btn-grey" onclick="strike(3)">B≈ÅƒÑD XXX</button>
            </div>
        </div>
        <div class="card" style="text-align: center;">
            <div style="font-size: 12px;">SUMA PUNKT√ìW W TEJ RUNDZIE:</div>
            <div id="dsum" style="font-size: 50px; color: gold; font-weight: bold;">0</div>
            <button class="btn-grey" onclick="resetRound()">KONIEC RUNDY (ZERUJ SUMƒò)</button>
        </div>
    </div>

    <div>
        <div id="panel-rounds">
            <div class="card">
                <h3>4. WYB√ìR ZESTAWU RUNDY (1-25)</h3>
                <select id="q-sel" onchange="loadQ()"></select>
                <button class="btn-gold" onclick="sendQ()" style="height:50px; margin-top:10px">WY≈öLIJ PYTANIE NA TV</button>
                <button class="btn-red" onclick="showFinal()" style="margin-top:10px">URUCHOM TRYB FINA≈ÅU</button>
            </div>
            <div class="card">
                <h3>KONTROLA ODPOWIEDZI</h3>
                <div id="ans-box" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;"></div>
            </div>
        </div>

        <div id="panel-final">
            <div class="card">
                <h3>üèÜ SYSTEM FINA≈ÅOWY</h3>
                <div class="grid-2">
                    <button class="btn-red" onclick="send({type:'TIMER', val:15})">TIMER 15s (G1)</button>
                    <button class="btn-red" onclick="send({type:'TIMER', val:20})">TIMER 20s (G2)</button>
                </div>
                <button class="btn-grey" onclick="showRounds()" style="margin-top:10px">POWR√ìT DO RUND</button>
            </div>
            <div class="card">
                <h3>ZESTAWY FINA≈ÅOWE (POMOCNIK)</h3>
                <select id="f-q-sel" onchange="loadFinalHelper()"></select>
                <div id="final-helper" class="helper-text">Wybierz zestaw, aby zobaczyƒá podpowiedzi dla graczy.</div>
                
                <table style="margin-top:15px">
                    <tr><th>NR</th><th>GRACZ 1 (Has≈Ço | Pkt)</th><th>GRACZ 2 (Has≈Ço | Pkt)</th></tr>
                    <tbody id="f-table-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // --- BAZA DANYCH ---
        const DB = [
            {q:"1. Wiƒôcej ni≈º jedno zwierzƒô?", a:[["OWCE",40],["STADO",30],["LAMA",20],["WATAHA",10]]},
            {q:"2. Co robimy rano?", a:[["MYJEMY ZƒòBY",40],["JEMY ≈öNIADANIE",35],["UBIERAMY SIƒò",15],["PIJEMY KAWƒò",10]]},
            {q:"3. Przedmiot szkolny na M?", a:[["MATEMATYKA",60],["MUZYKA",30],["METROLOGIA",10]]},
            {q:"4. Co ro≈õnie w lesie?", a:[["DRZEWA",50],["GRZYBY",30],["JAGODY",15],["MECH",5]]},
            {q:"5. Dyscyplina sportowa?", a:[["PI≈ÅKA NO≈ªNA",45],["SIATK√ìWKA",25],["KOSZYK√ìWKA",20]]},
            {q:"6. Co mo≈ºna piƒá na zimno?", a:[["WODA",40],["SOK",30],["COLA",20],["MLEKO",10]]},
            {q:"7. Marka samochodu?", a:[["FIAT",30],["BMW",25],["AUDI",20],["TOYOTA",15]]},
            {q:"8. Dzie≈Ñ tygodnia na P?", a:[["PONIEDZIA≈ÅEK",50],["PIƒÑTEK",40]]},
            {q:"9. Miasto w Polsce?", a:[["WARSZAWA",40],["KRAK√ìW",30],["WROC≈ÅAW",20]]},
            {q:"10. Co na pla≈ºƒô?", a:[["RƒòCZNIK",40],["KREM",30],["PI≈ÅKA",20],["KOC",10]]},
            {q:"11. Co w pi√≥rniku?", a:[["D≈ÅUGOPIS",40],["O≈Å√ìWEK",30],["GUMKA",20]]},
            {q:"12. Czƒô≈õƒá garderoby?", a:[["SPODNIE",40],["KOSZULKA",30],["BUTY",20]]},
            {q:"13. Warzywo do zupy?", a:[["MARCHEW",45],["PIETRUSZKA",25],["SELER",20]]},
            {q:"14. Instrument muzyczny?", a:[["GITARA",40],["PIANINO",30],["SKRZYPCE",20]]},
            {q:"15. Co kupujemy w piekarni?", a:[["CHLEB",60],["BU≈ÅKI",30],["PƒÑCZKA",10]]},
            {q:"16. Imiƒô mƒôskie na K?", a:[["KRZYSZTOF",40],["KAROL",30],["KAMIL",20]]},
            {q:"17. Co≈õ zimnego?", a:[["LODY",50],["≈öNIEG",30],["L√ìD",20]]},
            {q:"18. Zaw√≥d medyczny?", a:[["LEKARZ",50],["PIELƒòGNIARKA",30]]},
            {q:"19. Co ma ko≈Ça?", a:[["SAMOCH√ìD",50],["ROWER",30],["W√ìZEK",20]]},
            {q:"20. Co≈õ s≈Çonego?", a:[["S√ìL",40],["PALUSZKI",30],["CHIPSY",20]]},
            {q:"21. Krajobraz polski?", a:[["G√ìRY",40],["MORZE",30],["MAZURY",20]]},
            {q:"22. Sprzƒôt kuchenny?", a:[["LOD√ìWKA",40],["CZAJNIK",30],["MIKSER",20]]},
            {q:"23. Owoc na B?", a:[["BANAN",50],["BRZOSKWINIA",30],["BOR√ìWKA",20]]},
            {q:"24. Ptak polski?", a:[["BOCIAN",50],["WR√ìBEL",30],["GO≈ÅƒÑB",20]]},
            {q:"25. Jƒôzyk obcy?", a:[["ANGIELSKI",60],["NIEMIECKI",30]]}
        ];

        const F_DB = [
            {n:"Zestaw Fina≈Çowy 1", q:["Zwierzƒô z kopytami", "P≈Çyn do picia", "Co≈õ czerwonego", "MiesiƒÖc letni", "Czƒô≈õƒá twarzy"], h:["Ko≈Ñ(50),Krowa(25)", "Woda(40),Sok(30)", "Pomidor(30),Serce(20)", "Lipiec(45),Sierpie≈Ñ(35)", "Oko(40),Nos(30)"]},
            {n:"Zestaw Fina≈Çowy 2", q:["Pojazd dwuko≈Çowy", "Przedmiot w ≈Çazience", "Drzewo li≈õciaste", "Kwiat na randkƒô", "Imiƒô na M"], h:["Rower(50),Motor(30)", "Myd≈Ço(30),Rƒôcznik(20)", "DƒÖb(40),Brzoza(30)", "R√≥≈ºa(60),Tulipan(20)", "Maria(40),Monika(30)"]},
            {n:"Zestaw Fina≈Çowy 3", q:["Co≈õ s≈Çodkiego", "Sport zimowy", "Element ubrania", "Pa≈Ñstwo w Azji", "Narzƒôdzie"], h:["Czekolada(50),Ciastko(20)", "Narty(60),≈Åy≈ºwy(20)", "Kurtka(40),Czapka(20)", "Chiny(50),Japonia(30)", "M≈Çotek(45),Klucz(25)"]},
            {n:"Zestaw Fina≈Çowy 4", q:["Ryba rzeczna", "Co≈õ co ≈õwieci", "Miasto nad Wis≈ÇƒÖ", "Przedmiot w szkole", "Rodzaj buta"], h:["Karp(40),Szczupak(30)", "S≈Ço≈Ñce(50),≈ªar√≥wka(30)", "Warszawa(60),Krak√≥w(30)", "Zeszyt(40),KsiƒÖ≈ºka(30)", "Trampki(30),Kozaki(20)"]},
            {n:"Zestaw Fina≈Çowy 5", q:["Zwierzƒô domowe", "Planeta", "Owoc z pestkƒÖ", "Gatunek muzyki", "Co≈õ co lata"], h:["Pies(50),Kot(40)", "Ziemia(40),Mars(30)", "≈öliwka(40),Brzoskwinia(30)", "Pop(40),Rock(30)", "Ptak(50),Samolot(40)"]},
            {n:"Zestaw Fina≈Çowy 6", q:["Co≈õ okrƒÖg≈Çego", "Mebel do spania", "Zupa polska", "Co≈õ metalowego", "Pora roku"], h:["Pi≈Çka(40),Ko≈Ço(30)", "≈Å√≥≈ºko(60),Kanapa(20)", "Ros√≥≈Ç(50),Pomidorowa(30)", "Klucz(30),Gwo≈∫d≈∫(20)", "Lato(40),Wiosna(30)"]}
        ];

        let conn, peer = new Peer(), s1=0, s2=0, rSum=0, activeTeam='blue';

        window.onload = () => {
            const s = document.getElementById('q-sel'); DB.forEach((x,i)=> s.innerHTML += `<option value="${i}">${x.q}</option>`);
            const fs = document.getElementById('f-q-sel'); F_DB.forEach((x,i)=> fs.innerHTML += `<option value="${i}">${x.n}</option>`);
            const ft = document.getElementById('f-table-body');
            for(let i=0; i<5; i++) {
                ft.innerHTML += `<tr><td>${i+1}</td>
                <td><input id="f1t-${i}" style="width:70px"><input id="f1p-${i}" type="number" style="width:40px"><button onclick="revF(1,${i})">OK</button></td>
                <td><input id="f2t-${i}" style="width:70px"><input id="f2p-${i}" type="number" style="width:40px"><button onclick="revF(2,${i})">OK</button></td></tr>`;
            }
            setTeam('blue'); loadQ();
        };

        function connect() { conn = peer.connect(document.getElementById('tv-id').value); conn.on('open',()=>alert("PO≈ÅƒÑCZONO Z TABLICƒÑ!")); }
        function setTeam(t) { activeTeam=t; document.getElementById('p-blue').classList.toggle('active-team', t==='blue'); document.getElementById('p-red').classList.toggle('active-team', t==='red'); update(); }
        
        function loadQ() {
            const q = DB[document.getElementById('q-sel').value]; const box = document.getElementById('ans-box'); box.innerHTML = '';
            q.a.forEach((x, i) => {
                const b = document.createElement('button'); b.className = 'btn-grey'; b.innerText = `${x[0]} (${x[1]})`;
                b.onclick = () => { if(!b.disabled){ rSum+=x[1]; if(activeTeam==='blue') s1+=x[1]; else s2+=x[1]; update(); send({type:'REV', idx:i}); b.style.background='green'; b.disabled=true; }};
                box.appendChild(b);
            });
        }

        function loadFinalHelper() {
            const q = F_DB[document.getElementById('f-q-sel').value];
            let html = "<b>PYTANIA FINA≈ÅOWE:</b><br>";
            q.q.forEach((text, i) => html += `${i+1}. ${text} <span style="color:white">[${q.h[i]}]</span><br>`);
            document.getElementById('final-helper').innerHTML = html;
        }

        function sendQ() { rSum=0; update(); send({type:'SETUP', ans: DB[document.getElementById('q-sel').value].a.map(x=>({t:x[0], p:x[1]}))}); loadQ(); }
        function strike(n) { send({type:'STRIKE', n:n, team:activeTeam}); }
        function showFinal() { document.getElementById('panel-rounds').style.display='none'; document.getElementById('panel-final').style.display='block'; send({type:'FINAL_UI'}); }
        function showRounds() { document.getElementById('panel-rounds').style.display='block'; document.getElementById('panel-final').style.display='none'; }
        function revF(p, i) { send({type:'FINAL_REV', p:p, i:i, txt:document.getElementById(`f${p}t-${i}`).value.toUpperCase(), pts:document.getElementById(`f${p}p-${i}`).value}); }
        function resetRound() { rSum=0; update(); }
        function update() { document.getElementById('dsum').innerText=rSum; send({type:'SCORE', s1:s1, s2:s2, sum:rSum, active:activeTeam}); }
        function send(d) { if(conn) conn.send(d); }
    </script>
</body>
</html>
