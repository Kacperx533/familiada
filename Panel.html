<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - FAMILIADA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 12px; border-top: 4px solid #ffcc00; }
        button { padding: 12px; margin: 5px 0; width: 100%; cursor: pointer; font-weight: bold; border-radius: 6px; border: none; transition: 0.2s; }
        .gold { background: #ffcc00; color: #000; } 
        .blue { background: #0055ff; color: white; } 
        .red { background: #ff0044; color: white; }
        .active { outline: 3px solid white; box-shadow: 0 0 15px rgba(255,255,255,0.4); }
        input, select { width: 100%; padding: 12px; margin: 8px 0; background: #000; color: #fff; border: 1px solid #333; border-radius: 6px; }
        h3 { margin-top: 0; color: #ffcc00; font-size: 16px; text-transform: uppercase; }
        .ans-btn { background: #333; color: #eee; text-align: left; padding-left: 20px; font-size: 16px; }
    </style>
</head>
<body>

    <div>
        <div class="card">
            <h3>1. SYNCHRONIZACJA</h3>
            <input type="text" id="tv-id" placeholder="Wklej ID z ekranu TV">
            <button class="gold" onclick="connect()">PO≈ÅƒÑCZ Z TABLICƒÑ</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button onclick="send({type:'INTRO'})">üé¨ START (CZO≈Å√ìWKA)</button>
            <button style="background: orange; color: black;" onclick="send({type:'REPEAT'})">üîî POWT√ìRZENIE</button>
            <button class="gold" onclick="send({type:'GO_FINAL'})">üèÅ PRZEJ≈öCIE DO FINA≈ÅU</button>
            <button onclick="send({type:'OUTRO'})">üìù NAPISY KO≈ÉCOWE</button>
        </div>

        <div class="card">
            <h3>3. PUNKTY I B≈ÅƒòDY</h3>
            <div style="display:flex; gap:10px;">
                <button id="btn-a" class="blue" onclick="selTeam('A')">LEWA (NIEBIESCY)</button>
                <button id="btn-b" class="red" onclick="selTeam('B')">PRAWA (CZERWONI)</button>
            </div>
            <button class="red" style="margin-top:15px; font-size: 18px;" onclick="sendStrike()">‚ùå DODAJ B≈ÅƒÑD (X)</button>
            <div style="text-align:center; font-size:32px; margin:20px 0; color: #ffcc00;">SUMA RUNDY: <span id="s-r">0</span></div>
            <button class="gold" style="height: 60px; font-size: 18px;" onclick="addPts()">PRZYPISZ PUNKTY DRU≈ªYNIE</button>
            <div style="display:flex; justify-content: space-around; margin-top: 10px; font-weight: bold;">
                <span>Pkt A: <span id="s-a">0</span></span>
                <span>Pkt B: <span id="s-b">0</span></span>
            </div>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>4. RUNDA I PYTANIA</h3>
            <select id="round-sel">
                <option value="1">RUNDA 1 (x1)</option>
                <option value="2">RUNDA 2 (x1)</option>
                <option value="3">RUNDA 3 (x2)</option>
                <option value="4">RUNDA 4 (x3)</option>
            </select>
            <select id="q-sel" onchange="preview()"></select>
            <button class="gold" style="height: 50px; margin-bottom: 15px;" onclick="sendSetup()">WY≈öLIJ PYTANIE NA TABLICƒò</button>
            <div id="ans-list"></div>
        </div>
    </div>

    <script>
        const db = [
            {q:"Co robimy w szkole na przerwie?", a:[["JEMY ≈öNIADANIE",40],["ROZMAWIAMY",30],["KORZYSTAMY Z TEL",15],["POWTARZAMY",10],["BIEGAMY",5]]},
            {q:"Ulubiony przedmiot szkolny?", a:[["WF",45],["INFORMATYKA",25],["MATEMATYKA",15],["POLSKI",10],["PLASTYKA",5]]},
            {q:"Rzecz potrzebna do pisania?", a:[["D≈ÅUGOPIS",55],["O≈Å√ìWEK",20],["KLAWIATURA",12],["PI√ìRO",8],["KREDKA",5]]},
            {q:"Zwierzƒô domowe na literƒô K?", a:[["KOT",60],["KANAREK",20],["KR√ìLIK",15],["CHOMIK (KUMAK)",5]]},
            {q:"Co kojarzy siƒô z wakacjami?", a:[["MORZE",40],["S≈ÅO≈ÉCE",25],["LODY",20],["PLA≈ªA",10],["G√ìRY",5]]},
            {q:"Co mo≈ºna dostaƒá od nauczyciela?", a:[["OCENƒò",48],["POCHWA≈Åƒò",22],["UWAGƒò",15],["ZADANIE",10],["PYTANIE",5]]}
        ];

        let peer = new Peer(), conn, sA=0, sB=0, sR=0, team='A';

        window.onload = () => {
            const sel = document.getElementById('q-sel');
            db.forEach((it, i) => sel.innerHTML += `<option value="${i}">${it.q}</option>`);
            preview(); selTeam('A');
        };

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => alert("PO≈ÅƒÑCZONO Z TABLICƒÑ!"));
        }

        function send(d) { if(conn) conn.send(d); }

        function preview() {
            const data = db[document.getElementById('q-sel').value];
            const div = document.getElementById('ans-list'); div.innerHTML = "";
            const mult = parseInt(document.getElementById('round-sel').value === "3" ? 2 : (document.getElementById('round-sel').value === "4" ? 3 : 1));
            data.a.forEach((ans, i) => {
                div.innerHTML += `<button class="ans-btn" onclick="reveal(${i}, ${ans[1]})">${ans[0]} (${ans[1] * mult})</button>`;
            });
        }

        function sendSetup() {
            sR = 0; updateUI();
            const q = db[document.getElementById('q-sel').value];
            const r = document.getElementById('round-sel').value;
            const m = r == 3 ? 2 : (r == 4 ? 3 : 1);
            send({type:'SETUP_ROUND', rNum: r, mult: m, answers: q.a.map(x=>({text:x[0], points:x[1]}))});
            preview();
        }

        function reveal(idx, pts) {
            const r = document.getElementById('round-sel').value;
            const m = r == 3 ? 2 : (r == 4 ? 3 : 1);
            sR += (pts * m); updateUI();
            send({type:'REVEAL', idx:idx});
            sync();
        }

        function sendStrike() { send({type:'STRIKE', team: team}); }
        function selTeam(t) { 
            team = t; 
            document.getElementById('btn-a').classList.toggle('active', t==='A');
            document.getElementById('btn-b').classList.toggle('active', t==='B');
        }
        function addPts() {
            if(team==='A') sA += sR; else sB += sR;
            sR = 0; updateUI(); sync();
        }
        function updateUI() {
            document.getElementById('s-a').innerText = sA;
            document.getElementById('s-b').innerText = sB;
            document.getElementById('s-r').innerText = sR;
        }
        function sync() { send({type:'SCORE', r:sR, t:sA+sB}); }
    </script>
</body>
</html>
