<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL KONTROLNY - EDYCJA SZKOLNA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #2d2d2d; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #ffcc00; }
        button { padding: 12px; margin: 5px 0; width: 100%; cursor: pointer; font-weight: bold; border-radius: 4px; border: none; }
        .gold { background: #ffcc00; } .blue { background: #0055ff; color: white; } .red { background: #ff0044; color: white; }
        .active { outline: 4px solid white; box-shadow: 0 0 15px white; }
        input, select { width: 100%; padding: 10px; margin: 5px 0; box-sizing: border-box; background: #000; color: #fff; border: 1px solid #444; }
        h3 { margin-top: 0; color: #ffcc00; text-transform: uppercase; font-size: 14px; }
    </style>
</head>
<body>

    <div class="left">
        <div class="card">
            <h3>1. PO≈ÅƒÑCZENIE</h3>
            <input type="text" id="tv-id" placeholder="Wklej ID z TV">
            <button class="gold" onclick="connect()">PO≈ÅƒÑCZ Z TABLICƒÑ</button>
        </div>

        <div class="card">
            <h3>2. MULTIMEDIA</h3>
            <button onclick="send({type:'INTRO'})">üé¨ START (CZO≈Å√ìWKA + NAPIS)</button>
            <button onclick="send({type:'OUTRO'})">üìù NAPISY KO≈ÉCOWE</button>
            <button style="background: orange;" onclick="send({type:'REPEAT'})">üîî POWT√ìRZENIE</button>
        </div>

        <div class="card">
            <h3>3. PUNKTY I B≈ÅƒòDY</h3>
            <div style="display:flex; gap:10px;">
                <button id="btn-a" class="blue" onclick="selTeam('A')">DRU≈ªYNA A (LEWA): <span id="s-a">0</span></button>
                <button id="btn-b" class="red" onclick="selTeam('B')">DRU≈ªYNA B (PRAWA): <span id="s-b">0</span></button>
            </div>
            <button class="red" style="margin-top:10px; font-size: 20px;" onclick="sendStrike()">‚ùå B≈ÅƒÑD DLA AKTYWNEJ</button>
            <div style="text-align:center; font-size:24px; margin:15px; color: gold;">W TEJ RUNDZIE: <span id="s-r">0</span></div>
            <button class="gold" onclick="addPts()">DODAJ PUNKTY DO AKTYWNEJ</button>
        </div>
    </div>

    <div class="right">
        <div class="card">
            <h3>4. BAZA PYTA≈É (EDYCJA SZKOLNA)</h3>
            <select id="q-sel" onchange="preview()"></select>
            <button class="gold" onclick="sendSetup()">WY≈öLIJ PYTANIE NA TABLICƒò</button>
            <div id="ans-list"></div>
        </div>
    </div>

    <script>
        const db = [
            {q:"Przedmiot szkolny?", a:[["MATEMATYKA",45],["POLSKI",25],["WF",15],["HISTORIA",10],["BIOLOGIA",5]]},
            {q:"Co robimy na przerwie?", a:[["JEMY ≈öNIADANIE",40],["ROZMAWIAMY",30],["BIEGAMY",15],["POWTARZAMY",10],["GRAMY NA TEL",5]]},
            {q:"Wyposa≈ºenie pi√≥rnika?", a:[["D≈ÅUGOPIS",50],["O≈Å√ìWEK",20],["GUMKA",15],["LINIJKA",10],["KREDKI",5]]},
            {q:"Co mo≈ºna dostaƒá od nauczyciela?", a:[["OCENƒò",45],["POCHWA≈Åƒò",25],["UWAGƒò",15],["ZADANIE",10],["PYTANIE",5]]},
            {q:"Gdzie je≈∫dzimy na wycieczki?", a:[["KINO",35],["MUZEUM",30],["G√ìRY",20],["LAS",10],["BASEN",5]]},
            {q:"Co jest w plecaku opr√≥cz ksiƒÖ≈ºek?", a:[["ZESZYT",40],["≈öNIADANIE",30],["WODA",15],["STR√ìJ NA WF",10],["TELEFON",5]]}
        ];

        let peer = new Peer(), conn, scoreA=0, scoreB=0, scoreR=0, team='A';

        window.onload = () => {
            const sel = document.getElementById('q-sel');
            db.forEach((it, i) => sel.innerHTML += `<option value="${i}">${it.q}</option>`);
            preview(); selTeam('A');
        };

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => alert("Po≈ÇƒÖczono!"));
        }

        function send(d) { if(conn) conn.send(d); }

        function preview() {
            const data = db[document.getElementById('q-sel').value];
            const div = document.getElementById('ans-list'); div.innerHTML = "";
            data.a.forEach((ans, i) => {
                div.innerHTML += `<button onclick="reveal(${i}, ${ans[1]})">${ans[0]} (${ans[1]})</button>`;
            });
        }

        function sendSetup() {
            scoreR = 0; updateUI();
            const data = db[document.getElementById('q-sel').value];
            send({type:'SETUP_ROUND', answers: data.a.map(x=>({text:x[0], points:x[1]}))});
        }

        function reveal(idx, pts) {
            scoreR += pts; updateUI();
            send({type:'REVEAL', idx:idx});
            sync();
        }

        function sendStrike() { send({type:'STRIKE', team: team}); }

        function selTeam(t) {
            team = t;
            document.getElementById('btn-a').classList.toggle('active', t==='A');
            document.getElementById('btn-b').classList.toggle('active', t==='B');
        }

        function addPts() {
            if(team==='A') scoreA += scoreR; else scoreB += scoreR;
            scoreR = 0; updateUI(); sync();
        }

        function updateUI() {
            document.getElementById('s-a').innerText = scoreA;
            document.getElementById('s-b').innerText = scoreB;
            document.getElementById('s-r').innerText = scoreR;
        }

        function sync() { send({type:'SCORE', r:scoreR, t:scoreA+scoreB}); }
    </script>
</body>
</html>
