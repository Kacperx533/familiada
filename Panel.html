<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA</title>
    <style>
        body { font-family: sans-serif; background: #111; color: white; padding: 20px; }
        .box { background: #222; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #333; }
        input, button { padding: 10px; margin: 5px; border-radius: 5px; border: none; }
        button { cursor: pointer; background: #444; color: white; font-weight: bold; }
        button:hover { background: #555; }
        .yellow { background: #f4ff00; color: #000; }
        .red { background: #ff3333; color: white; }
        .row { display: flex; align-items: center; background: #2a2a2a; margin-bottom: 5px; padding: 5px; border-radius: 5px; }
        input[type="text"] { flex: 2; }
        input[type="number"] { width: 60px; }
    </style>
</head>
<body>

    <div class="box">
        <h2>POŁĄCZENIE</h2>
        <input type="text" id="target" placeholder="KOD Z TABLICY">
        <button onclick="connect()" class="yellow">POŁĄCZ</button>
        <span id="stat" style="color: red; margin-left: 10px;">Brak połączenia</span>
    </div>

    <div class="box">
        <h2>RUNDA</h2>
        <button onclick="send('SETUP')">RESET TABLICY (NOWE PYTANIE)</button>
        <div id="inputs"></div>
        <div style="margin-top: 15px;">
            <button onclick="sendX(1)" class="red">X (BŁĄD)</button>
            <button onclick="sendX(2)" class="red">XX</button>
            <button onclick="sendX(3)" class="red">XXX</button>
        </div>
    </div>

    <audio id="snd-x" src="https://www.myinstants.com/media/sounds/familiada-x.mp3"></audio>
    <audio id="snd-ok" src="https://www.myinstants.com/media/sounds/familiada-poprawna.mp3"></audio>

    <script>
        let conn;
        const peer = new Peer();
        const ins = document.getElementById('inputs');

        for(let i=0; i<6; i++) {
            ins.innerHTML += `<div class="row">
                <span>${i+1}</span>
                <input type="text" id="t${i}" placeholder="Hasło">
                <input type="number" id="p${i}" placeholder="Pkt">
                <button onclick="reveal(${i})">ODKRYJ</button>
            </div>`;
        }

        function connect() {
            const id = document.getElementById('target').value.toUpperCase();
            conn = peer.connect(id);
            conn.on('open', () => {
                document.getElementById('stat').innerText = "POŁĄCZONO!";
                document.getElementById('stat').style.color = "lime";
            });
        }

        function send(type) { if(conn) conn.send({type}); }

        function reveal(idx) {
            const t = document.getElementById(`t${idx}`).value;
            const p = document.getElementById(`p${idx}`).value;
            if(conn) {
                conn.send({ type: 'REV', idx, t, p });
                document.getElementById('snd-ok').play();
            }
        }

        function sendX(count) {
            if(conn) {
                conn.send({ type: 'X', count });
                document.getElementById('snd-x').play();
            }
        }
    </script>
</body>
</html>
