<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - LED</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #222; color: #eee; padding: 20px; display: grid; grid-template-columns: 350px 1fr; gap: 20px; }
        .card { background: #333; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #dfff00; }
        h3 { margin: 0 0 10px 0; color: #dfff00; font-size: 14px; text-transform: uppercase; }
        button { width: 100%; padding: 12px; margin: 4px 0; background: #555; border: none; color: white; cursor: pointer; border-radius: 4px; font-weight: bold; }
        button:hover { background: #666; }
        
        .btn-action { background: #dfff00; color: black; }
        .btn-red { background: #ff4444; }
        .btn-blue { background: #4444ff; }
        
        .active-team { outline: 3px solid white; }
        
        input { width: 100%; padding: 10px; box-sizing: border-box; background: #111; border: 1px solid #555; color: white; margin-bottom: 5px; }
        
        #ans-box { display: grid; grid-template-columns: 1fr; gap: 5px; }
        .ans-btn { text-align: left; display: flex; justify-content: space-between; padding: 10px 20px; }
    </style>
</head>
<body>

    <div>
        <div class="card">
            <h3>1. Po≈ÇƒÖczenie</h3>
            <input id="tv-id" placeholder="Wpisz ID z ekranu TV">
            <button class="btn-action" onclick="connect()">PO≈ÅƒÑCZ Z TV</button>
        </div>

        <div class="card">
            <h3>2. Sterowanie Rundy</h3>
            <div style="display:flex; gap:5px;">
                <button class="btn-blue" id="btn-b" onclick="setTeam('blue')">NIEBIESCY</button>
                <button class="btn-red" id="btn-r" onclick="setTeam('red')">CZERWONI</button>
            </div>
            <div style="margin-top:10px; display:flex; gap:5px;">
                <button onclick="strike(1)">X</button>
                <button onclick="strike(2)">XX</button>
                <button onclick="strike(3)">XXX</button>
            </div>
            <button onclick="clearStrike()" style="margin-top:5px; background:#222; border:1px solid #555;">USU≈É X Z EKRANU</button>
        </div>

        <div class="card">
            <h3>3. Multimedia</h3>
            <button onclick="send({type:'VIDEO'})">üé¨ CZO≈Å√ìWKA</button>
        </div>
    </div>

    <div>
        <div class="card">
            <h3>4. Pytania i Odpowiedzi</h3>
            <select id="q-sel" style="width:100%; padding:10px; margin-bottom:10px; background:#111; color:white; border:1px solid #555;" onchange="loadQ()">
                </select>
            <button class="btn-action" onclick="sendQ()">ZA≈ÅADUJ PYTANIE NA TABLICƒò (RESET)</button>
            
            <div style="margin-top: 20px; border-top: 1px solid #555; padding-top: 10px;">
                <div id="ans-box"></div>
            </div>

            <div style="margin-top: 20px; font-size: 20px; text-align: right;">
                SUMA: <span id="round-sum" style="color:#dfff00; font-weight:bold;">0</span>
            </div>
        </div>
    </div>

    <script>
        // BAZA PYTA≈É - mo≈ºesz tu wkleiƒá swoje 25 pyta≈Ñ
        const DB = [
            {q:"1. Region w Polsce?", a:[["≈öLƒÑSK",36],["KASZUBY",27],["PODHALE",17],["MAZURY",10],["WIELKOPOLSKA",5]]},
            {q:"2. Co jemy ≈Çy≈ºkƒÖ?", a:[["ZUPƒò",40],["LODY",30],["P≈ÅATKI",20],["KISIEL",10]]},
            {q:"3. Zwierzƒô le≈õne?", a:[["DZIK",35],["SARNA",25],["LIS",20],["WILK",10],["ZAJƒÑC",5]]},
            {q:"4. Marka samochodu?", a:[["FIAT",30],["OPEL",20],["TOYOTA",15],["FORD",10],["BMW",5]]},
            {q:"5. Kolor flagi?", a:[["BIA≈ÅY",40],["CZERWONY",40],["NIEBIESKI",10]]}
        ];

        let conn;
        const peer = new Peer();
        let currentSum = 0;
        let activeTeam = 'blue';

        window.onload = () => {
            const s = document.getElementById('q-sel');
            DB.forEach((item, index) => {
                s.innerHTML += `<option value="${index}">${item.q}</option>`;
            });
            loadQ();
            setTeam('blue');
        };

        function connect() {
            const id = document.getElementById('tv-id').value;
            conn = peer.connect(id);
            conn.on('open', () => alert("Po≈ÇƒÖczono z ekranem TV!"));
        }

        function loadQ() {
            const idx = document.getElementById('q-sel').value;
            const data = DB[idx];
            const container = document.getElementById('ans-box');
            container.innerHTML = '';
            
            data.a.forEach((ans, i) => {
                const b = document.createElement('button');
                b.className = 'ans-btn';
                b.innerHTML = `<span>${i+1}. ${ans[0]}</span> <span>${ans[1]}</span>`;
                b.onclick = () => reveal(i, ans[1], b);
                container.appendChild(b);
            });
        }

        function sendQ() {
            const idx = document.getElementById('q-sel').value;
            const data = DB[idx];
            currentSum = 0;
            updateSum();
            // Wysy≈Çamy strukturƒô odpowiedzi do TV
            const payload = {
                type: 'SETUP',
                ans: data.a.map(item => ({t: item[0], p: item[1]}))
            };
            if(conn) conn.send(payload);
        }

        function reveal(index, points, btnElement) {
            if(btnElement.disabled) return;
            btnElement.disabled = true;
            btnElement.style.background = 'green';
            
            currentSum += points;
            updateSum();

            if(conn) {
                conn.send({type: 'REV', idx: index});
                conn.send({type: 'SCORE', sum: currentSum});
            }
        }

        function strike(n) {
            if(conn) conn.send({type: 'STRIKE', n: n});
        }
        
        function clearStrike() {
            if(conn) conn.send({type: 'CLEAR_STRIKE'});
        }

        function setTeam(t) {
            activeTeam = t;
            document.getElementById('btn-b').classList.toggle('active-team', t === 'blue');
            document.getElementById('btn-r').classList.toggle('active-team', t === 'red');
        }

        function updateSum() {
            document.getElementById('round-sum').innerText = currentSum;
        }

        function send(data) {
            if(conn) conn.send(data);
        }
    </script>
</body>
</html>
