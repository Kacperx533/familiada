<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA - FAMILIADA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; padding: 20px; }
        .card { background: #1e1e1e; padding: 20px; margin: 10px; border-radius: 12px; border: 1px solid #333; }
        button { padding: 12px; margin: 5px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
        .btn-gold { background: #f5b041; color: black; }
        .btn-red { background: #ff4444; color: white; }
        .btn-blue { background: #4444ff; color: white; }
        input { padding: 10px; background: #000; color: white; border: 1px solid #444; }
        .score-box { font-size: 30px; margin: 15px 0; color: #f5b041; border: 2px solid #333; padding: 10px; text-align: center; }
    </style>
</head>
<body>

    <div class="card">
        <h3>1. PO≈ÅƒÑCZENIE</h3>
        <input type="text" id="target-id" placeholder="WPISZ KOD Z TV">
        <button class="btn-gold" onclick="connect()">PO≈ÅƒÑCZ Z TV</button>
    </div>

    <div class="card">
        <h3>2. EFEKTY I RUNDY</h3>
        <button class="btn-gold" onclick="s({type:'INTRO'})">üé¨ CZO≈Å√ìWKA + NAPIS</button>
        <button onclick="s({type:'SOUND', name:'runda'})">üîî D≈πWIƒòK RUNDY</button>
        <button onclick="s({type:'SOUND', name:'final'})">üèÜ D≈πWIƒòK FINA≈ÅU</button>
        <button class="btn-red" onclick="s({type:'SOUND', name:'powtorzenie'})">‚ö†Ô∏è POWT√ìRZENIE (FINA≈Å)</button>
    </div>

    <div class="card">
        <h3>3. PUNKTACJA DRU≈ªYN</h3>
        <div class="score-box">
            A: <span id="sA">0</span> pkt | B: <span id="sB">0</span> pkt
        </div>
        <div style="font-size: 18px;">Punkty z bie≈ºƒÖcej rundy: <span id="currentRound">0</span></div><br>
        <button class="btn-red" onclick="addScore('A')">PRZEKA≈ª PUNKTY DLA A</button>
        <button class="btn-blue" onclick="addScore('B')">PRZEKA≈ª PUNKTY DLA B</button>
        <button onclick="resetScores()">ZERUJ WYNIK GRY</button>
    </div>

    <div class="card">
        <h3>4. B≈ÅƒòDY (X)</h3>
        <button class="btn-red" onclick="strike('A')">DRU≈ªYNA A (X)</button>
        <button class="btn-blue" onclick="strike('B')">DRU≈ªYNA B (X)</button>
        <button onclick="clearStrikes()">USU≈É WSZYSTKIE X</button>
    </div>

    <div class="card">
        <h3>5. ODPOWIEDZI (TESTOWE)</h3>
        <button onclick="loadDemo()">ZA≈ÅADUJ PYTANIE TESTOWE</button>
        <div id="ans-list"></div>
    </div>

<script>
    let peer = new Peer(), conn;
    let scoreA = 0, scoreB = 0, roundSum = 0;
    let stA = 0, stB = 0;

    function connect() {
        conn = peer.connect(document.getElementById('target-id').value);
        conn.on('open', () => alert("PO≈ÅƒÑCZONO!"));
    }

    function s(m) { if(conn) conn.send(m); }

    function loadDemo() {
        const q = {ans: [{t:"MATEMATYKA",p:45},{t:"POLSKI",p:30},{t:"HISTORIA",p:15},{t:"GEOGRAFIA",p:10}]};
        roundSum = 0; stA = 0; stB = 0;
        s({type:'SETUP', ans: q.ans});
        s({type:'SYNC', rt: 0});
        
        document.getElementById('ans-list').innerHTML = q.ans.map((a,i)=>`
            <button onclick="reveal(${i}, ${a.p})">${a.t} (${a.p})</button>
        `).join('');
    }

    function reveal(idx, pts) {
        roundSum += pts;
        document.getElementById('currentRound').innerText = roundSum;
        s({type:'REVEAL', idx: idx});
        s({type:'SYNC', rt: roundSum});
    }

    function addScore(team) {
        if(team === 'A') scoreA += roundSum; else scoreB += roundSum;
        roundSum = 0;
        document.getElementById('sA').innerText = scoreA;
        document.getElementById('sB').innerText = scoreB;
        document.getElementById('currentRound').innerText = 0;
        s({type:'SYNC', rt: 0});
    }

    function strike(team) {
        if(team === 'A') stA++; else stB++;
        s({type:'STRIKE', team: team, count: (team === 'A' ? stA : stB)});
    }

    function clearStrikes() {
        stA = 0; stB = 0;
        s({type:'STRIKE', team: 'A', count: 0});
        s({type:'STRIKE', team: 'B', count: 0});
    }

    function resetScores() {
        scoreA = 0; scoreB = 0;
        document.getElementById('sA').innerText = 0;
        document.getElementById('sB').innerText = 0;
    }
</script>
</body>
</html>
