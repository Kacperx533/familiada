<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>PANEL STEROWANIA</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; }
        .card { background: #333; padding: 15px; border-radius: 10px; margin-bottom: 10px; }
        button { padding: 12px; margin: 5px; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; }
        .btn-green { background: #2ecc71; } .btn-red { background: #e74c3c; width: 100%; height: 80px; font-size: 30px; }
        select, input { width: 100%; padding: 10px; margin: 5px 0; background: #000; color: white; border: 1px solid #555; }
    </style>
</head>
<body>
    <div class="card">
        <input type="text" id="tv-id" placeholder="WPISZ ID Z TELEWIZORA">
        <button onclick="connect()" class="btn-green">POŁĄCZ Z TV</button>
    </div>

    <div id="controls" style="display:none">
        <div class="card">
            <h4>Wybierz pytanie:</h4>
            <select id="q-select" onchange="loadQ()">
                <option value="0">Zwierzę na K?</option>
                <option value="1">Co pijemy rano?</option>
                <option value="2">Dyscyplina sportowa?</option>
            </select>
            <button onclick="sendQ()">WYŚLIJ PYTANIE NA TV</button>
        </div>

        <div class="card" id="ans-list"></div>

        <div class="card">
            <button class="btn-red" onclick="sendStrike()">✖ BŁĄD (X)</button>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <input type="number" id="scA" value="0" onchange="sync()">
                <input type="number" id="scB" value="0" onchange="sync()">
            </div>
        </div>
    </div>

    <script>
        let peer = new Peer(), conn, currentQ;
        const db = [
            { q: "Zwierzę na literę K?", a: [["Kot", 45], ["Koń", 25], ["Krowa", 15], ["Kangur", 5]] },
            { q: "Co pijemy rano?", a: [["Kawa", 50], ["Herbata", 30], ["Woda", 10], ["Mleko", 5]] },
            { q: "Dyscyplina sportowa?", a: [["Piłka Nożna", 60], ["Siatkówka", 20], ["Tenis", 10]] }
        ];

        function connect() {
            conn = peer.connect(document.getElementById('tv-id').value);
            conn.on('open', () => document.getElementById('controls').style.display = 'block');
        }

        function loadQ() {
            const idx = document.getElementById('q-select').value;
            currentQ = db[idx];
            const list = document.getElementById('ans-list'); list.innerHTML = '';
            currentQ.a.forEach((ans, i) => {
                list.innerHTML += `<button onclick="reveal(${i})">${ans[0]} (${ans[1]})</button>`;
            });
        }

        function sendQ() { conn.send({type: 'SETUP', q: currentQ.q, a: currentQ.a.map(x=>({t:x[0], p:x[1]})) }); }
        function reveal(i) { conn.send({type: 'REVEAL', index: i, text: currentQ.a[i][0], pts: currentQ.a[i][1] }); }
        function sendStrike() { conn.send({type: 'STRIKE'}); }
        function sync() { conn.send({type: 'UPDATE', scA: document.getElementById('scA').value, scB: document.getElementById('scB').value}); }
    </script>
</body>
</html>
